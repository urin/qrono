{"version":3,"file":"qrono.cjs","sources":["../src/helpers.js","../src/qrono.js"],"sourcesContent":["export const epoch = new Date(0)\n\n/**\n * When creating or updating a local time, both `Date.setFullYear` and `Date.setHours` are used.\n * Noon is used as the initial reference point to avoid the time after `setFullYear`\n * from falling into an ambiguous DST period. Historically, DST transitions in all countries\n * have been scheduled around midnight, and it should be the same in the future.\n * The reason for selecting 1915 as the initial value is as follows.\n * Since DST was first established in 1916, the initial value should be set to a year prior to that.\n * If a year too far in the past is chosen, it may correspond to a period when time zones were not yet\n * precisely defined in some regions, which could result in unexpected timezone offsets.\n */\nexport const initialSafeDate = new Date(1915, 0, 1, 12, 0, 0, 0)\n\nexport const daysPerWeek = 7\nexport const hoursPerDay = 24\nexport const hoursPerWeek = hoursPerDay * daysPerWeek\nexport const minutesPerHour = 60\nexport const minutesPerDay = minutesPerHour * hoursPerDay\nexport const minutesPerWeek = minutesPerDay * daysPerWeek\nexport const secondsPerMinute = 60\nexport const secondsPerHour = secondsPerMinute * minutesPerHour\nexport const secondsPerDay = secondsPerHour * hoursPerDay\nexport const secondsPerWeek = secondsPerDay * daysPerWeek\nexport const millisecondsPerSecond = 1000\nexport const millisecondsPerMinute = secondsPerMinute * millisecondsPerSecond\nexport const millisecondsPerHour = secondsPerHour * millisecondsPerSecond\nexport const millisecondsPerDay = secondsPerDay * millisecondsPerSecond\nexport const millisecondsPerWeek = secondsPerWeek * millisecondsPerSecond\n\nexport function has(object, ...keys) {\n  return keys.flat().some(object.hasOwnProperty, object)\n}\n\nexport function fields(object) {\n  return Object.entries(object)\n    .filter(([, value]) => !isFunction(value))\n    .map(([key]) => key)\n}\n\nexport function given(arg) {\n  return arg !== undefined\n}\n\nexport function isFunction(a) {\n  return a instanceof Function\n}\n\nexport function isString(a) {\n  return typeof a === 'string' || a instanceof String\n}\n\nexport function isObject(a) {\n  return a !== null && typeof a === 'object' && a.constructor === Object\n}\n\nexport function isValidDate(date) {\n  return !Number.isNaN(date.getTime())\n}\n\nexport function hasDateField(object) {\n  return has(object, ['year', 'month', 'day'])\n}\n\nexport function hasTimeField(object) {\n  return has(object, ['hour', 'minute', 'second', 'millisecond'])\n}\n\nexport function hasDatetimeField(object) {\n  return has(object, [\n    'year',\n    'month',\n    'day',\n    'hour',\n    'minute',\n    'second',\n    'millisecond',\n  ])\n}\n","/* @ts-self-types=\"../types/qrono.d.ts\" */\nimport {\n  has,\n  given,\n  fields,\n  isObject,\n  isString,\n  isValidDate,\n  hasDatetimeField,\n  initialSafeDate,\n  daysPerWeek,\n  minutesPerDay,\n  minutesPerHour,\n  millisecondsPerMinute,\n  millisecondsPerDay,\n} from './helpers.js'\n\n// -----------------------------------------------------------------------------\n// Exports\n// -----------------------------------------------------------------------------\nconst qrono = Qrono\n\nexport { qrono }\n\n// -----------------------------------------------------------------------------\n// Static\n// -----------------------------------------------------------------------------\nQrono.date = QronoDate\n\n// NOTE Must be flat object for shallow cloning.\nconst defaultContext = {\n  localtime: false,\n  disambiguation: 'compatible',\n}\n\nfor (const key of fields(defaultContext)) {\n  Qrono[key] = function (arg) {\n    if (given(arg)) {\n      defaultContext[key] = arg\n      return this\n    }\n    return defaultContext[key]\n  }\n}\n\nQrono.context = function (context) {\n  if (given(context)) {\n    for (const key of fields(defaultContext)) {\n      if (!has(context, key)) {\n        continue\n      }\n      defaultContext[key] = context[key]\n    }\n    return this\n  }\n  return { ...defaultContext }\n}\n\nQrono.asUtc = function () {\n  defaultContext.localtime = false\n  return this\n}\n\nQrono.asLocaltime = function () {\n  defaultContext.localtime = true\n  return this\n}\n\nconst monday = 1\nconst tuesday = 2\nconst wednesday = 3\nconst thursday = 4\nconst friday = 5\nconst saturday = 6\nconst sunday = 7\n\nObject.assign(Qrono, {\n  monday,\n  tuesday,\n  wednesday,\n  thursday,\n  friday,\n  saturday,\n  sunday,\n})\n\n// -----------------------------------------------------------------------------\n// Constructor\n// -----------------------------------------------------------------------------\nconst internal = Symbol()\n\nfunction Qrono(...args) {\n  if (!new.target) {\n    return new Qrono(...args)\n  }\n  const self = {\n    // properties\n    nativeDate: null,\n    localtime: false,\n    disambiguation: 'compatible',\n    // methods\n    set,\n    parse,\n    valid,\n    context,\n    getNative,\n  }\n  this[internal] = self\n\n  // Construction\n  self.context(defaultContext)\n  if (args[0] instanceof Qrono) {\n    const source = args.shift()\n    for (const key of fields(self)) {\n      self[key] = source[key]()\n    }\n  }\n  if (isObject(args[0]) && !hasDatetimeField(args[0])) {\n    self.context(args.shift())\n  }\n  const first = args[0]\n  const second = args[1]\n  if (first == null) {\n    self.nativeDate ??= new Date()\n  } else if (first instanceof Date) {\n    self.nativeDate = new Date(first.getTime())\n  } else if (isString(first)) {\n    self.parse(first)\n  } else if (isObject(first)) {\n    if (!hasDatetimeField(first)) {\n      throw RangeError(\n        'Missing time field' +\n          ' (year, minute, day, hour, minute, second or millisecond)'\n      )\n    }\n    self.set(first)\n  } else if (Number.isFinite(first) && !Number.isFinite(second)) {\n    self.nativeDate = new Date(first)\n  } else if (Number.isFinite(first) || Array.isArray(first)) {\n    const flat = args.flat()\n    const values = flat.filter(v => Number.isSafeInteger(v))\n    if (values.length !== flat.length) {\n      throw RangeError('Should be safe integers')\n    }\n    if (values.length > 7) {\n      throw RangeError('Too many numbers')\n    }\n    self.set({\n      year: values[0],\n      month: values[1],\n      day: values[2],\n      hour: values[3],\n      minute: values[4],\n      second: values[5],\n      millisecond: values[6],\n    })\n  } else {\n    throw TypeError(`Invalid argument ${args}`)\n  }\n  return this\n}\n\n// -----------------------------------------------------------------------------\n// Private methods\n// -----------------------------------------------------------------------------\nfunction valid() {\n  return isValidDate(this.nativeDate)\n}\n\nfunction context(context) {\n  if (!context) {\n    return\n  }\n  for (const key of fields(defaultContext)) {\n    if (has(context, key)) {\n      this[key] = context[key]\n    }\n  }\n  return this\n}\n\nfunction getNative(name) {\n  return this.nativeDate[`get${this.localtime ? '' : 'UTC'}${name}`]()\n}\n\nfunction set(values) {\n  const args = { ...values }\n  args.month = args.month && args.month - 1\n  if (!this.localtime) {\n    const baseDate = this.nativeDate ?? new Date(0)\n    const newDate = new Date(0)\n    newDate.setUTCFullYear(\n      args.year ?? baseDate.getUTCFullYear(),\n      args.month ?? baseDate.getUTCMonth(),\n      args.day ?? baseDate.getUTCDate()\n    )\n    newDate.setUTCHours(\n      args.hour ?? baseDate.getUTCHours(),\n      args.minute ?? baseDate.getUTCMinutes(),\n      args.second ?? baseDate.getUTCSeconds(),\n      args.millisecond ?? baseDate.getUTCMilliseconds()\n    )\n    this.nativeDate = newDate\n    return this\n  }\n  const dateOnly = !has(values, 'hour', 'minute', 'second', 'millisecond')\n  const disambig = dateOnly ? 'later' : this.disambiguation\n  const baseDate = this.nativeDate ?? new Date(0, 0)\n  const newDate = new Date(initialSafeDate.getTime())\n  const requested = {\n    year: args.year ?? baseDate.getFullYear(),\n    month: args.month ?? baseDate.getMonth(),\n    day: args.day ?? baseDate.getDate(),\n    hour: args.hour ?? (dateOnly ? 0 : baseDate.getHours()),\n    minute: args.minute ?? (dateOnly ? 0 : baseDate.getMinutes()),\n    second: args.second ?? (dateOnly ? 0 : baseDate.getSeconds()),\n    millisecond:\n      args.millisecond ?? (dateOnly ? 0 : baseDate.getMilliseconds()),\n  }\n  newDate.setFullYear(requested.year, requested.month, requested.day)\n  newDate.setHours(\n    requested.hour,\n    requested.minute,\n    requested.second,\n    requested.millisecond\n  )\n  // Compute the offset-delta between the day before and after.\n  const numeric = newDate.getTime()\n  const nextDay = new Date(numeric)\n  nextDay.setDate(newDate.getDate() + 1)\n  const prevDay = new Date(numeric)\n  prevDay.setDate(newDate.getDate() - 1)\n  const adjust = nextDay.getTimezoneOffset() - prevDay.getTimezoneOffset()\n  // No DST transition nearby â€” nothing to resolve.\n  if (disambig === 'compatible' || adjust === 0) {\n    this.nativeDate = newDate\n    return this\n  }\n  // Detect whether the constructed Date landed in a DST gap (missing time).\n  // In a gap, JavaScript silently shifts the time forward.\n  const isGap =\n    requested.year * 1e8 +\n      requested.month * 1e6 +\n      requested.day * 1e4 +\n      requested.hour * 1e2 +\n      requested.minute <\n    newDate.getFullYear() * 1e8 +\n      newDate.getMonth() * 1e6 +\n      newDate.getDate() * 1e4 +\n      newDate.getHours() * 1e2 +\n      newDate.getMinutes()\n  // Compute the standard-time candidate.\n  // Verify the candidate actually preserves the original local fields.\n  // If it doesn't, the time isn't truly in an overlap.\n  const adjustedUTC = new Date(\n    new Date(numeric).setUTCMinutes(newDate.getUTCMinutes() + adjust)\n  )\n  const isOverlap =\n    adjustedUTC.getHours() === newDate.getHours() &&\n    adjustedUTC.getMinutes() === newDate.getMinutes()\n  if (!isGap && !isOverlap) {\n    this.nativeDate = newDate\n    return this\n  }\n  if (disambig === 'reject') {\n    throw new RangeError(`Requested local time ${requested} is ambiguous.`)\n  }\n  this.nativeDate = disambig === 'later' ? newDate : adjustedUTC\n  return this\n}\n\nconst parsePattern = new RegExp(\n  // yyyy[[-|/]MM[[-|/]DD]]\n  '^(\\\\d{4})(?:[-/]?([0-2]?\\\\d)(?:[-/]?([0-3]?\\\\d))?)?' +\n    // [(T| )HH[:]mm[[:]ss[(.|:)SSS]]]\n    '(?:[T\\\\s]([0-2]?\\\\d)(?::([0-5]?\\\\d)?(?::([0-6]?\\\\d)?(?:[.:](\\\\d{1,3})?\\\\d*)?)?)?)?' +\n    // [Z|(+|-)hh:mm]\n    '(Z|[-+]\\\\d{2}:?\\\\d{2})?$'\n)\n\nfunction parse(str) {\n  const text = str.trim().toUpperCase()\n  const values = text.match(parsePattern)\n  if (!values) {\n    throw RangeError(\n      `Failed to parse '${str}'.` +\n        ' Should be yyyy[[-|/]MM[[-|/]DD]][(T| )HH:mm[:ss[(.|:)SSS]]][Z|(+|-)hh:mm]'\n    )\n  }\n  const hasTime = values[4] !== undefined\n  const [year, month, day, offset] = [\n    +values[1],\n    +values[2] || 1,\n    +values[3] || 1,\n    values[8],\n  ]\n  const native = new Date(text)\n  if (!isValidDate(native)) {\n    throw RangeError(\n      `Failed to parse '${str}' by Date.` +\n        ' Should be yyyy[[-|/]MM[[-|/]DD]][(T| )HH:mm[:ss[(.|:)SSS]]][Z|(+|-)hh:mm]'\n    )\n  }\n  if (offset) {\n    this.nativeDate = native\n  } else if (hasTime) {\n    this.set({\n      year,\n      month,\n      day,\n      hour: +values[4] || 0,\n      minute: +values[5] || 0,\n      second: +values[6] || 0,\n      millisecond: +values[7]?.padStart(3, '0') || 0,\n    })\n  } else {\n    this.set({ year, month, day })\n  }\n  return this\n}\n\n// -----------------------------------------------------------------------------\n// Public methods\n// -----------------------------------------------------------------------------\nconst p = (v, n) => String(v).padStart(n, '0')\n\n// Basic\nQrono.prototype.toString = function () {\n  if (this[internal].localtime) {\n    const t = this[internal].nativeDate\n    const offset = -t.getTimezoneOffset()\n    const offsetAbs = Math.abs(offset)\n    return (\n      `${p(t.getFullYear(), 4)}-` +\n      `${p(t.getMonth() + 1, 2)}-` +\n      `${p(t.getDate(), 2)}T` +\n      `${p(t.getHours(), 2)}:` +\n      `${p(t.getMinutes(), 2)}:` +\n      `${p(t.getSeconds(), 2)}.` +\n      `${p(t.getMilliseconds(), 3)}` +\n      `${offset >= 0 ? '+' : '-'}` +\n      `${p(Math.trunc(offsetAbs / minutesPerHour), 2)}:` +\n      `${p(offsetAbs % minutesPerHour, 2)}`\n    )\n  }\n  return this[internal].nativeDate.toISOString()\n}\n\nQrono.prototype.valueOf = function () {\n  return this[internal].nativeDate.valueOf()\n}\n\nQrono.prototype.clone = function (...args) {\n  return new Qrono(this, ...args)\n}\n\nQrono.prototype.context = function (context) {\n  return given(context)\n    ? this.clone(context)\n    : {\n        localtime: this[internal].localtime,\n        disambiguation: this[internal].disambiguation,\n      }\n}\n\nQrono.prototype.nativeDate = function () {\n  return new Date(this[internal].nativeDate.getTime())\n}\n\nQrono.prototype.offset = function () {\n  return this[internal].localtime\n    ? -this[internal].nativeDate.getTimezoneOffset()\n    : 0\n}\n\nQrono.prototype.localtime = function (arg) {\n  return given(arg) ? this.clone({ localtime: arg }) : this[internal].localtime\n}\n\nQrono.prototype.disambiguation = function (arg) {\n  return given(arg)\n    ? this.clone({ disambiguation: arg })\n    : this[internal].disambiguation\n}\n\nQrono.prototype.valid = function () {\n  return this[internal].valid()\n}\n\n// Transform\nQrono.prototype.numeric = function () {\n  return this[internal].nativeDate.getTime()\n}\n\nQrono.prototype.toObject = function () {\n  return {\n    year: this.year(),\n    month: this.month(),\n    day: this.day(),\n    hour: this.hour(),\n    minute: this.minute(),\n    second: this.second(),\n    millisecond: this.millisecond(),\n  }\n}\n\nQrono.prototype.toArray = function () {\n  return [\n    this.year(),\n    this.month(),\n    this.day(),\n    this.hour(),\n    this.minute(),\n    this.second(),\n    this.millisecond(),\n  ]\n}\n\nQrono.prototype.toDate = function (...args) {\n  return new QronoDate(this.clone(...args))\n}\n\n// Context\nQrono.prototype.asUtc = function () {\n  return this.clone({ localtime: false })\n}\n\nQrono.prototype.asLocaltime = function () {\n  return this.clone({ localtime: true })\n}\n\n// Accessor\nfor (const [field, native, offset] of [\n  ['year', 'FullYear', 0],\n  ['month', 'Month', 1],\n  ['day', 'Date', 0],\n  ['hour', 'Hours', 0],\n  ['minute', 'Minutes', 0],\n  ['second', 'Seconds', 0],\n  ['millisecond', 'Milliseconds', 0],\n]) {\n  Qrono.prototype[field] = function (value) {\n    return given(value)\n      ? this.clone({ [field]: value })\n      : this[internal].getNative(native) + offset\n  }\n}\n\n// Getter\nQrono.prototype.dayOfWeek = function () {\n  return 1 + ((this[internal].getNative('Day') - 1 + daysPerWeek) % daysPerWeek)\n}\n\nQrono.prototype.dayOfYear = function () {\n  const date = this.toDate()\n  return 1 + date - date.startOfYear()\n}\n\nQrono.prototype.weekOfYear = function () {\n  const date = this.toDate()\n  const theThursday = date.day(date.day() - date.dayOfWeek() + thursday)\n  const startOfYear = theThursday.startOfYear()\n  const firstThursday =\n    startOfYear.dayOfWeek() === thursday\n      ? startOfYear\n      : startOfYear.day(\n          1 + ((thursday - startOfYear.dayOfWeek() + daysPerWeek) % daysPerWeek)\n        )\n  return 1 + Math.ceil((theThursday - firstThursday) / daysPerWeek)\n}\n\nQrono.prototype.yearOfWeek = function () {\n  const date = this.toDate()\n  return date.day(date.day() - date.dayOfWeek() + thursday).year()\n}\n\nQrono.prototype.isLeapYear = function () {\n  const year = this.year()\n  return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)\n}\n\nQrono.prototype.hasDstInYear = function () {\n  if (!this[internal].localtime) {\n    return false\n  }\n  const currentOffset = this.offset()\n  return [3, 6, 9, 12]\n    .map(month => this.month(month).offset())\n    .some(offset => offset !== currentOffset)\n}\n\nQrono.prototype.isInDst = function () {\n  if (!this[internal].localtime) {\n    return false\n  }\n  const offsets = Array.from({ length: 12 }, (_, index) =>\n    this.month(index + 1).offset()\n  )\n  const minOffset = Math.min(...offsets)\n  const maxOffset = Math.max(...offsets)\n  return minOffset !== maxOffset && this.offset() === maxOffset\n}\n\nQrono.prototype.isDstTransitionDay = function () {\n  if (!this[internal].localtime) {\n    return false\n  }\n  return this.minutesInDay() !== minutesPerDay\n}\n\nQrono.prototype.minutesInDay = function () {\n  if (!this[internal].localtime) {\n    return minutesPerDay\n  }\n  const startOfDay = this.context({ disambiguation: 'later' }).startOfDay()\n  const nextDay = startOfDay.plus({ day: 1 }).startOfDay()\n  if (startOfDay.day() === nextDay.day()) {\n    return minutesPerDay\n  }\n  return (nextDay - startOfDay) / millisecondsPerMinute\n}\n\nQrono.prototype.daysInMonth = function () {\n  const days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\n  const month = this.month()\n  return days[month - 1] + (this.isLeapYear() && month === 2 ? 1 : 0)\n}\n\nQrono.prototype.daysInYear = function () {\n  return this.isLeapYear() ? 366 : 365\n}\n\nQrono.prototype.weeksInYear = function () {\n  const endOfYear = this.toDate({ month: 12, day: 31 })\n  const endOfLastYear = endOfYear.minus({ year: 1 })\n  if (\n    endOfYear.dayOfWeek() === thursday ||\n    endOfLastYear.dayOfWeek() === wednesday\n  ) {\n    return 53\n  }\n  return 52\n}\n\nfor (const [name, cloneArg] of [\n  ['Year', { month: 1, day: 1, hour: 0, minute: 0, second: 0, millisecond: 0 }],\n  ['Month', { day: 1, hour: 0, minute: 0, second: 0, millisecond: 0 }],\n  ['Hour', { minute: 0, second: 0, millisecond: 0 }],\n  ['Minute', { second: 0, millisecond: 0 }],\n  ['Second', { millisecond: 0 }],\n]) {\n  Qrono.prototype[`startOf${name}`] = function () {\n    return this.clone(cloneArg)\n  }\n}\n\nQrono.prototype.startOfDay = function () {\n  const timestamp = this.clone(\n    { disambiguation: 'later' },\n    { hour: 0, minute: 0, second: 0, millisecond: 0 }\n  ).numeric()\n  return this.clone(timestamp)\n}\n\nQrono.prototype.isSame = function (another) {\n  return +this === +another\n}\nQrono.prototype.isBefore = function (another) {\n  return this < another\n}\nQrono.prototype.isAfter = function (another) {\n  return this > another\n}\nQrono.prototype.isSameOrBefore = function (another) {\n  return this <= another\n}\nQrono.prototype.isSameOrAfter = function (another) {\n  return this >= another\n}\nQrono.prototype.isBetween = function (a, b) {\n  return (a <= this && this <= b) || (b <= this && this <= a)\n}\n\n// Calculation\nQrono.prototype.plus = function (...args) {\n  return plus.call(this, 1, ...args)\n}\n\nQrono.prototype.minus = function (...args) {\n  return plus.call(this, -1, ...args)\n}\n\nfunction plus(sign, ...args) {\n  const arg0 = args[0]\n  const arg1 = args[1]\n  if (Number.isFinite(arg0) && !Number.isFinite(arg1)) {\n    return this.clone(this.numeric() + arg0)\n  }\n  let timeFields = null\n  if (isObject(arg0)) {\n    if (!hasDatetimeField(arg0)) {\n      throw RangeError(\n        'Missing time field' +\n          ' (year, minute, day, hour, minute, second or millisecond)'\n      )\n    }\n    timeFields = arg0\n  } else if (Number.isFinite(arg0) || Array.isArray(arg0)) {\n    const flat = args.flat()\n    const values = flat.filter(v => Number.isSafeInteger(v))\n    if (values.length !== flat.length) {\n      throw RangeError('Should be safe integers')\n    }\n    if (values.length > 7) {\n      throw RangeError('Too many numbers')\n    }\n    timeFields = {\n      year: values[0],\n      month: values[1],\n      day: values[2],\n      hour: values[3],\n      minute: values[4],\n      second: values[5],\n      millisecond: values[6],\n    }\n  } else {\n    throw TypeError()\n  }\n  const date = this.nativeDate()\n  const utc = this[internal].localtime ? '' : 'UTC'\n  if (has(timeFields, 'year') || has(timeFields, 'month')) {\n    const year = this.year() + sign * (timeFields.year ?? 0)\n    const month = this.month() + sign * (timeFields.month ?? 0)\n    const endOfMonth = new Date(date.getTime())\n    endOfMonth[`set${utc}FullYear`](year, month, 0)\n    const lastDay = endOfMonth[`get${utc}Date`]()\n    if (lastDay < this.day()) {\n      date[`set${utc}FullYear`](year, endOfMonth[`get${utc}Month`](), lastDay)\n    } else {\n      date[`set${utc}FullYear`](year, month - 1)\n    }\n  }\n  if (has(timeFields, 'day')) {\n    date[`set${utc}Date`](date[`get${utc}Date`]() + sign * timeFields.day)\n  }\n  for (const [key, nativeKey] of [\n    ['hour', 'Hours'],\n    ['minute', 'Minutes'],\n    ['second', 'Seconds'],\n    ['millisecond', 'Milliseconds'],\n  ]) {\n    if (!has(timeFields, key) || timeFields[key] == null) {\n      continue\n    }\n    date[`setUTC${nativeKey}`](\n      date[`getUTC${nativeKey}`]() + sign * timeFields[key]\n    )\n  }\n  return this.clone(date)\n}\n\n// -----------------------------------------------------------------------------\n// QronoDate Class\n// -----------------------------------------------------------------------------\nconst internalDate = Symbol()\n\nfunction QronoDate(...args) {\n  if (!new.target) {\n    return new QronoDate(...args)\n  }\n  const self = { datetime: null }\n  this[internalDate] = self\n  let source = null\n  if (args[0] instanceof QronoDate) {\n    source = args.shift().toDatetime()\n  } else if (args[0] instanceof Qrono) {\n    source = args.shift()\n  }\n  const first = args[0]\n  const second = args[1]\n  if (Number.isFinite(first) && !Number.isFinite(second)) {\n    args[0] = Math.floor(first) * millisecondsPerDay\n  }\n  if (source) {\n    source = source.clone(...args)\n  } else {\n    source = qrono(...args)\n  }\n  self.datetime = source.startOfDay()\n  return this\n}\n\nQronoDate.prototype.toString = function () {\n  return this[internalDate].datetime.toString().substring(0, 10)\n}\n\nQronoDate.prototype.valueOf = function () {\n  return this[internalDate].datetime / millisecondsPerDay\n}\n\nQronoDate.prototype.valid = function () {\n  return this[internalDate].datetime.valid()\n}\n\nQronoDate.prototype.clone = function (...args) {\n  return new QronoDate(this, ...args)\n}\n\nQronoDate.prototype.toDatetime = function () {\n  return qrono(this[internalDate].datetime.toArray())\n}\n\nQronoDate.prototype.numeric = function () {\n  return this[internalDate].datetime.numeric() / millisecondsPerDay\n}\n\nQronoDate.prototype.toObject = function () {\n  return {\n    year: this.year(),\n    month: this.month(),\n    day: this.day(),\n  }\n}\n\nQronoDate.prototype.toArray = function () {\n  return [this.year(), this.month(), this.day()]\n}\n\nQronoDate.prototype.startOfYear = function () {\n  return new QronoDate(this[internalDate].datetime.startOfYear())\n}\n\nQronoDate.prototype.startOfMonth = function () {\n  return new QronoDate(this[internalDate].datetime.startOfMonth())\n}\n\nQronoDate.prototype.startOfDay = function () {\n  return this[internalDate].datetime.clone()\n}\nfor (const field of ['year', 'month', 'day']) {\n  QronoDate.prototype[field] = function (value) {\n    if (given(value)) {\n      return new QronoDate(this[internalDate].datetime[field](value))\n    }\n    return this[internalDate].datetime[field]()\n  }\n}\nfor (const method of [\n  'dayOfWeek',\n  'dayOfYear',\n  'weekOfYear',\n  'yearOfWeek',\n  'isLeapYear',\n  'daysInMonth',\n  'daysInYear',\n  'weeksInYear',\n]) {\n  QronoDate.prototype[method] = function () {\n    return this[internalDate].datetime[method]()\n  }\n}\nfor (const method of ['minutesInDay', 'hasDstInYear', 'isDstTransitionDay']) {\n  QronoDate.prototype[method] = function () {\n    return qrono(\n      { disambiguation: 'later' },\n      this[internalDate].datetime.toArray().slice(0, 3)\n    )[method]()\n  }\n}\n\nQronoDate.prototype.endOfYear = function () {\n  return this.clone({ month: 12, day: 31 })\n}\n\nQronoDate.prototype.endOfMonth = function () {\n  return this.clone({ day: this.daysInMonth() })\n}\n\nQronoDate.prototype.isSame = function (another) {\n  return +this === +another\n}\nQronoDate.prototype.isBefore = function (another) {\n  return this < another\n}\nQronoDate.prototype.isAfter = function (another) {\n  return this > another\n}\nQronoDate.prototype.isSameOrBefore = function (another) {\n  return this <= another\n}\nQronoDate.prototype.isSameOrAfter = function (another) {\n  return this >= another\n}\nQronoDate.prototype.isBetween = function (a, b) {\n  return (a <= this && this <= b) || (b <= this && this <= a)\n}\n\nQronoDate.prototype.plus = function (...args) {\n  return plusDate.call(this, 1, ...args)\n}\n\nQronoDate.prototype.minus = function (...args) {\n  return plusDate.call(this, -1, ...args)\n}\n\nfunction plusDate(sign, ...args) {\n  const arg0 = args[0]\n  const arg1 = args[1]\n  const datetime = this[internalDate].datetime\n  if (Number.isFinite(arg0) && !Number.isFinite(arg1)) {\n    return datetime.plus({ day: sign * arg0 }).toDate()\n  }\n  let timeFields = null\n  if (isObject(arg0) && hasDatetimeField(arg0)) {\n    timeFields = {\n      year: sign * (arg0.year ?? 0),\n      month: sign * (arg0.month ?? 0),\n      day: sign * (arg0.day ?? 0),\n    }\n  } else if (Number.isFinite(arg0)) {\n    if (args.length > 3) {\n      throw RangeError('Too many arguments')\n    }\n    timeFields = { year: sign * arg0, month: sign * arg1, day: sign * arg2 }\n  } else if (Array.isArray(arg0)) {\n    if (arg0.length > 3) {\n      throw RangeError('Too many elements')\n    }\n    timeFields = {\n      year: sign * arg0[0],\n      month: sign * arg0[1],\n      day: sign * arg0[2],\n    }\n  } else {\n    throw TypeError()\n  }\n  return datetime.plus(timeFields).toDate()\n}\n"],"names":["initialSafeDate","daysPerWeek","hoursPerDay","minutesPerHour","minutesPerDay","secondsPerMinute","secondsPerHour","secondsPerDay","millisecondsPerSecond","millisecondsPerMinute","millisecondsPerDay","has","object","keys","fields","value","isFunction","key","given","arg","a","isString","isObject","isValidDate","date","hasDatetimeField","qrono","Qrono","QronoDate","defaultContext","context","__spreadValues","monday","tuesday","wednesday","thursday","friday","saturday","sunday","internal","args","self","set","parse","valid","getNative","source","first","second","_a","flat","values","v","name","baseDate","newDate","_b","_c","_d","_e","_f","_g","_h","dateOnly","disambig","_i","requested","_j","_k","_l","_m","_n","_o","_p","numeric","nextDay","prevDay","adjust","isGap","adjustedUTC","isOverlap","parsePattern","str","text","hasTime","year","month","day","offset","native","n","offsetAbs","field","theThursday","startOfYear","firstThursday","currentOffset","offsets","_","index","minOffset","maxOffset","startOfDay","days","endOfYear","endOfLastYear","cloneArg","timestamp","another","b","plus","sign","arg0","arg1","timeFields","utc","endOfMonth","lastDay","nativeKey","internalDate","method","plusDate","datetime"],"mappings":"+aAYO,MAAMA,GAAkB,IAAI,KAAK,KAAM,EAAG,EAAG,GAAI,EAAG,EAAG,CAAC,EAElDC,EAAc,EACdC,EAAc,GAEdC,EAAiB,GACjBC,EAAgBD,EAAiBD,EAEjCG,EAAmB,GACnBC,GAAiBD,EAAmBF,EACpCI,GAAgBD,GAAiBJ,EAEjCM,EAAwB,IACxBC,GAAwBJ,EAAmBG,EAE3CE,EAAqBH,GAAgBC,EAG3C,SAASG,EAAIC,KAAWC,EAAM,CACnC,OAAOA,EAAK,KAAI,EAAG,KAAKD,EAAO,eAAgBA,CAAM,CACvD,CAEO,SAASE,EAAOF,EAAQ,CAC7B,OAAO,OAAO,QAAQA,CAAM,EACzB,OAAO,CAAC,CAAA,CAAGG,CAAK,IAAM,CAACC,GAAWD,CAAK,CAAC,EACxC,IAAI,CAAC,CAACE,CAAG,IAAMA,CAAG,CACvB,CAEO,SAASC,EAAMC,EAAK,CACzB,OAAOA,IAAQ,MACjB,CAEO,SAASH,GAAWI,EAAG,CAC5B,OAAOA,aAAa,QACtB,CAEO,SAASC,GAASD,EAAG,CAC1B,OAAO,OAAOA,GAAM,UAAYA,aAAa,MAC/C,CAEO,SAASE,EAASF,EAAG,CAC1B,OAAOA,IAAM,MAAQ,OAAOA,GAAM,UAAYA,EAAE,cAAgB,MAClE,CAEO,SAASG,GAAYC,EAAM,CAChC,MAAO,CAAC,OAAO,MAAMA,EAAK,QAAO,CAAE,CACrC,CAUO,SAASC,EAAiBb,EAAQ,CACvC,OAAOD,EAAIC,EAAQ,CACjB,OACA,QACA,MACA,OACA,SACA,SACA,aACJ,CAAG,CACH,CC1DK,MAACc,EAAQC,EAOdA,EAAM,KAAOC,EAGb,MAAMC,EAAiB,CACrB,UAAW,GACX,eAAgB,YAClB,EAEA,UAAWZ,KAAOH,EAAOe,CAAc,EACrCF,EAAMV,CAAG,EAAI,SAAUE,EAAK,CAC1B,OAAID,EAAMC,CAAG,GACXU,EAAeZ,CAAG,EAAIE,EACf,MAEFU,EAAeZ,CAAG,CAC3B,EAGFU,EAAM,QAAU,SAAUG,EAAS,CACjC,GAAIZ,EAAMY,CAAO,EAAG,CAClB,UAAWb,KAAOH,EAAOe,CAAc,EAChClB,EAAImB,EAASb,CAAG,IAGrBY,EAAeZ,CAAG,EAAIa,EAAQb,CAAG,GAEnC,OAAO,IACT,CACA,OAAOc,EAAA,GAAKF,EACd,EAEAF,EAAM,MAAQ,UAAY,CACxB,OAAAE,EAAe,UAAY,GACpB,IACT,EAEAF,EAAM,YAAc,UAAY,CAC9B,OAAAE,EAAe,UAAY,GACpB,IACT,EAEA,MAAMG,GAAS,EACTC,GAAU,EACVC,GAAY,EACZC,EAAW,EACXC,GAAS,EACTC,GAAW,EACXC,GAAS,EAEf,OAAO,OAAOX,EAAO,CACnB,OAAAK,GACA,QAAAC,GACA,UAAAC,GACA,SAAAC,EACA,OAAAC,GACA,SAAAC,GACA,OAAAC,EACF,CAAC,EAKD,MAAMC,EAAW,OAAM,EAEvB,SAASZ,KAASa,EAAM,OACtB,GAAI,CAAC,WACH,OAAO,IAAIb,EAAM,GAAGa,CAAI,EAE1B,MAAMC,EAAO,CAEX,WAAY,KACZ,UAAW,GACX,eAAgB,aAEhB,IAAAC,GACA,MAAAC,GACA,MAAAC,GACA,QAAAd,GACA,UAAAe,EACJ,EAKE,GAJA,KAAKN,CAAQ,EAAIE,EAGjBA,EAAK,QAAQZ,CAAc,EACvBW,EAAK,CAAC,YAAab,EAAO,CAC5B,MAAMmB,EAASN,EAAK,MAAK,EACzB,UAAWvB,KAAOH,EAAO2B,CAAI,EAC3BA,EAAKxB,CAAG,EAAI6B,EAAO7B,CAAG,EAAC,CAE3B,CACIK,EAASkB,EAAK,CAAC,CAAC,GAAK,CAACf,EAAiBe,EAAK,CAAC,CAAC,GAChDC,EAAK,QAAQD,EAAK,MAAK,CAAE,EAE3B,MAAMO,EAAQP,EAAK,CAAC,EACdQ,EAASR,EAAK,CAAC,EACrB,GAAIO,GAAS,MACXE,EAAAR,EAAK,aAAL,OAAAA,EAAK,WAAe,IAAI,cACfM,aAAiB,KAC1BN,EAAK,WAAa,IAAI,KAAKM,EAAM,QAAO,CAAE,UACjC1B,GAAS0B,CAAK,EACvBN,EAAK,MAAMM,CAAK,UACPzB,EAASyB,CAAK,EAAG,CAC1B,GAAI,CAACtB,EAAiBsB,CAAK,EACzB,MAAM,WACJ,6EAER,EAEIN,EAAK,IAAIM,CAAK,CAChB,SAAW,OAAO,SAASA,CAAK,GAAK,CAAC,OAAO,SAASC,CAAM,EAC1DP,EAAK,WAAa,IAAI,KAAKM,CAAK,UACvB,OAAO,SAASA,CAAK,GAAK,MAAM,QAAQA,CAAK,EAAG,CACzD,MAAMG,EAAOV,EAAK,KAAI,EAChBW,EAASD,EAAK,OAAOE,GAAK,OAAO,cAAcA,CAAC,CAAC,EACvD,GAAID,EAAO,SAAWD,EAAK,OACzB,MAAM,WAAW,yBAAyB,EAE5C,GAAIC,EAAO,OAAS,EAClB,MAAM,WAAW,kBAAkB,EAErCV,EAAK,IAAI,CACP,KAAMU,EAAO,CAAC,EACd,MAAOA,EAAO,CAAC,EACf,IAAKA,EAAO,CAAC,EACb,KAAMA,EAAO,CAAC,EACd,OAAQA,EAAO,CAAC,EAChB,OAAQA,EAAO,CAAC,EAChB,YAAaA,EAAO,CAAC,CAC3B,CAAK,CACH,KACE,OAAM,UAAU,oBAAoBX,CAAI,EAAE,EAE5C,OAAO,IACT,CAKA,SAASI,IAAQ,CACf,OAAOrB,GAAY,KAAK,UAAU,CACpC,CAEA,SAASO,GAAQA,EAAS,CACxB,GAAKA,EAGL,WAAWb,KAAOH,EAAOe,CAAc,EACjClB,EAAImB,EAASb,CAAG,IAClB,KAAKA,CAAG,EAAIa,EAAQb,CAAG,GAG3B,OAAO,KACT,CAEA,SAAS4B,GAAUQ,EAAM,CACvB,OAAO,KAAK,WAAW,MAAM,KAAK,UAAY,GAAK,KAAK,GAAGA,CAAI,EAAE,EAAC,CACpE,CAEA,SAASX,GAAIS,EAAQ,qCACnB,MAAMX,EAAOT,EAAA,GAAKoB,GAElB,GADAX,EAAK,MAAQA,EAAK,OAASA,EAAK,MAAQ,EACpC,CAAC,KAAK,UAAW,CACnB,MAAMc,GAAWL,EAAA,KAAK,aAAL,KAAAA,EAAmB,IAAI,KAAK,CAAC,EACxCM,EAAU,IAAI,KAAK,CAAC,EAC1B,OAAAA,EAAQ,gBACNC,EAAAhB,EAAK,OAAL,KAAAgB,EAAaF,EAAS,eAAc,GACpCG,EAAAjB,EAAK,QAAL,KAAAiB,EAAcH,EAAS,YAAW,GAClCI,EAAAlB,EAAK,MAAL,KAAAkB,EAAYJ,EAAS,WAAU,CACrC,EACIC,EAAQ,aACNI,EAAAnB,EAAK,OAAL,KAAAmB,EAAaL,EAAS,YAAW,GACjCM,EAAApB,EAAK,SAAL,KAAAoB,EAAeN,EAAS,cAAa,GACrCO,EAAArB,EAAK,SAAL,KAAAqB,EAAeP,EAAS,cAAa,GACrCQ,EAAAtB,EAAK,cAAL,KAAAsB,EAAoBR,EAAS,mBAAkB,CACrD,EACI,KAAK,WAAaC,EACX,IACT,CACA,MAAMQ,EAAW,CAACpD,EAAIwC,EAAQ,OAAQ,SAAU,SAAU,aAAa,EACjEa,EAAWD,EAAW,QAAU,KAAK,eACrCT,GAAWW,EAAA,KAAK,aAAL,KAAAA,EAAmB,IAAI,KAAK,EAAG,CAAC,EAC3CV,EAAU,IAAI,KAAKvD,GAAgB,QAAO,CAAE,EAC5CkE,EAAY,CAChB,MAAMC,EAAA3B,EAAK,OAAL,KAAA2B,EAAab,EAAS,YAAW,EACvC,OAAOc,EAAA5B,EAAK,QAAL,KAAA4B,EAAcd,EAAS,SAAQ,EACtC,KAAKe,EAAA7B,EAAK,MAAL,KAAA6B,EAAYf,EAAS,QAAO,EACjC,MAAMgB,EAAA9B,EAAK,OAAL,KAAA8B,EAAcP,EAAW,EAAIT,EAAS,WAC5C,QAAQiB,EAAA/B,EAAK,SAAL,KAAA+B,EAAgBR,EAAW,EAAIT,EAAS,aAChD,QAAQkB,EAAAhC,EAAK,SAAL,KAAAgC,EAAgBT,EAAW,EAAIT,EAAS,aAChD,aACEmB,EAAAjC,EAAK,cAAL,KAAAiC,EAAqBV,EAAW,EAAIT,EAAS,gBAAe,CAClE,EACEC,EAAQ,YAAYW,EAAU,KAAMA,EAAU,MAAOA,EAAU,GAAG,EAClEX,EAAQ,SACNW,EAAU,KACVA,EAAU,OACVA,EAAU,OACVA,EAAU,WACd,EAEE,MAAMQ,EAAUnB,EAAQ,QAAO,EACzBoB,EAAU,IAAI,KAAKD,CAAO,EAChCC,EAAQ,QAAQpB,EAAQ,QAAO,EAAK,CAAC,EACrC,MAAMqB,EAAU,IAAI,KAAKF,CAAO,EAChCE,EAAQ,QAAQrB,EAAQ,QAAO,EAAK,CAAC,EACrC,MAAMsB,EAASF,EAAQ,kBAAiB,EAAKC,EAAQ,kBAAiB,EAEtE,GAAIZ,IAAa,cAAgBa,IAAW,EAC1C,YAAK,WAAatB,EACX,KAIT,MAAMuB,EACJZ,EAAU,KAAO,IACfA,EAAU,MAAQ,IAClBA,EAAU,IAAM,IAChBA,EAAU,KAAO,IACjBA,EAAU,OACZX,EAAQ,YAAW,EAAK,IACtBA,EAAQ,SAAQ,EAAK,IACrBA,EAAQ,QAAO,EAAK,IACpBA,EAAQ,SAAQ,EAAK,IACrBA,EAAQ,WAAU,EAIhBwB,EAAc,IAAI,KACtB,IAAI,KAAKL,CAAO,EAAE,cAAcnB,EAAQ,cAAa,EAAKsB,CAAM,CACpE,EACQG,GACJD,EAAY,SAAQ,IAAOxB,EAAQ,SAAQ,GAC3CwB,EAAY,eAAiBxB,EAAQ,WAAU,EACjD,GAAI,CAACuB,GAAS,CAACE,GACb,YAAK,WAAazB,EACX,KAET,GAAIS,IAAa,SACf,MAAM,IAAI,WAAW,wBAAwBE,CAAS,gBAAgB,EAExE,YAAK,WAAaF,IAAa,QAAUT,EAAUwB,EAC5C,IACT,CAEA,MAAME,GAAe,IAAI,OAEvB,+JAKF,EAEA,SAAStC,GAAMuC,EAAK,OAClB,MAAMC,EAAOD,EAAI,KAAI,EAAG,YAAW,EAC7B/B,EAASgC,EAAK,MAAMF,EAAY,EACtC,GAAI,CAAC9B,EACH,MAAM,WACJ,oBAAoB+B,CAAG,8EAE7B,EAEE,MAAME,EAAUjC,EAAO,CAAC,IAAM,OACxB,CAACkC,EAAMC,EAAOC,EAAKC,CAAM,EAAI,CACjC,CAACrC,EAAO,CAAC,EACT,CAACA,EAAO,CAAC,GAAK,EACd,CAACA,EAAO,CAAC,GAAK,EACdA,EAAO,CAAC,CACZ,EACQsC,EAAS,IAAI,KAAKN,CAAI,EAC5B,GAAI,CAAC5D,GAAYkE,CAAM,EACrB,MAAM,WACJ,oBAAoBP,CAAG,sFAE7B,EAEE,OAAIM,EACF,KAAK,WAAaC,EACTL,EACT,KAAK,IAAI,CACP,KAAAC,EACA,MAAAC,EACA,IAAAC,EACA,KAAM,CAACpC,EAAO,CAAC,GAAK,EACpB,OAAQ,CAACA,EAAO,CAAC,GAAK,EACtB,OAAQ,CAACA,EAAO,CAAC,GAAK,EACtB,YAAa,GAACF,EAAAE,EAAO,CAAC,IAAR,YAAAF,EAAW,SAAS,EAAG,OAAQ,CACnD,CAAK,EAED,KAAK,IAAI,CAAE,KAAAoC,EAAM,MAAAC,EAAO,IAAAC,CAAG,CAAE,EAExB,IACT,CAKA,MAAM,EAAI,CAACnC,EAAGsC,IAAM,OAAOtC,CAAC,EAAE,SAASsC,EAAG,GAAG,EAG7C/D,EAAM,UAAU,SAAW,UAAY,CACrC,GAAI,KAAKY,CAAQ,EAAE,UAAW,CAC5B,MAAM,EAAI,KAAKA,CAAQ,EAAE,WACnBiD,EAAS,CAAC,EAAE,kBAAiB,EAC7BG,EAAY,KAAK,IAAIH,CAAM,EACjC,MACE,GAAG,EAAE,EAAE,YAAW,EAAI,CAAC,CAAC,IACrB,EAAE,EAAE,SAAQ,EAAK,EAAG,CAAC,CAAC,IACtB,EAAE,EAAE,QAAO,EAAI,CAAC,CAAC,IACjB,EAAE,EAAE,SAAQ,EAAI,CAAC,CAAC,IAClB,EAAE,EAAE,WAAU,EAAI,CAAC,CAAC,IACpB,EAAE,EAAE,WAAU,EAAI,CAAC,CAAC,IACpB,EAAE,EAAE,gBAAe,EAAI,CAAC,CAAC,GACzBA,GAAU,EAAI,IAAM,GAAG,GACvB,EAAE,KAAK,MAAMG,EAAYxF,CAAc,EAAG,CAAC,CAAC,IAC5C,EAAEwF,EAAYxF,EAAgB,CAAC,CAAC,EAEvC,CACA,OAAO,KAAKoC,CAAQ,EAAE,WAAW,YAAW,CAC9C,EAEAZ,EAAM,UAAU,QAAU,UAAY,CACpC,OAAO,KAAKY,CAAQ,EAAE,WAAW,QAAO,CAC1C,EAEAZ,EAAM,UAAU,MAAQ,YAAaa,EAAM,CACzC,OAAO,IAAIb,EAAM,KAAM,GAAGa,CAAI,CAChC,EAEAb,EAAM,UAAU,QAAU,SAAUG,EAAS,CAC3C,OAAOZ,EAAMY,CAAO,EAChB,KAAK,MAAMA,CAAO,EAClB,CACE,UAAW,KAAKS,CAAQ,EAAE,UAC1B,eAAgB,KAAKA,CAAQ,EAAE,cACvC,CACA,EAEAZ,EAAM,UAAU,WAAa,UAAY,CACvC,OAAO,IAAI,KAAK,KAAKY,CAAQ,EAAE,WAAW,QAAO,CAAE,CACrD,EAEAZ,EAAM,UAAU,OAAS,UAAY,CACnC,OAAO,KAAKY,CAAQ,EAAE,UAClB,CAAC,KAAKA,CAAQ,EAAE,WAAW,kBAAiB,EAC5C,CACN,EAEAZ,EAAM,UAAU,UAAY,SAAUR,EAAK,CACzC,OAAOD,EAAMC,CAAG,EAAI,KAAK,MAAM,CAAE,UAAWA,CAAG,CAAE,EAAI,KAAKoB,CAAQ,EAAE,SACtE,EAEAZ,EAAM,UAAU,eAAiB,SAAUR,EAAK,CAC9C,OAAOD,EAAMC,CAAG,EACZ,KAAK,MAAM,CAAE,eAAgBA,CAAG,CAAE,EAClC,KAAKoB,CAAQ,EAAE,cACrB,EAEAZ,EAAM,UAAU,MAAQ,UAAY,CAClC,OAAO,KAAKY,CAAQ,EAAE,MAAK,CAC7B,EAGAZ,EAAM,UAAU,QAAU,UAAY,CACpC,OAAO,KAAKY,CAAQ,EAAE,WAAW,QAAO,CAC1C,EAEAZ,EAAM,UAAU,SAAW,UAAY,CACrC,MAAO,CACL,KAAM,KAAK,KAAI,EACf,MAAO,KAAK,MAAK,EACjB,IAAK,KAAK,IAAG,EACb,KAAM,KAAK,KAAI,EACf,OAAQ,KAAK,OAAM,EACnB,OAAQ,KAAK,OAAM,EACnB,YAAa,KAAK,YAAW,CACjC,CACA,EAEAA,EAAM,UAAU,QAAU,UAAY,CACpC,MAAO,CACL,KAAK,KAAI,EACT,KAAK,MAAK,EACV,KAAK,IAAG,EACR,KAAK,KAAI,EACT,KAAK,OAAM,EACX,KAAK,OAAM,EACX,KAAK,YAAW,CACpB,CACA,EAEAA,EAAM,UAAU,OAAS,YAAaa,EAAM,CAC1C,OAAO,IAAIZ,EAAU,KAAK,MAAM,GAAGY,CAAI,CAAC,CAC1C,EAGAb,EAAM,UAAU,MAAQ,UAAY,CAClC,OAAO,KAAK,MAAM,CAAE,UAAW,EAAK,CAAE,CACxC,EAEAA,EAAM,UAAU,YAAc,UAAY,CACxC,OAAO,KAAK,MAAM,CAAE,UAAW,EAAI,CAAE,CACvC,EAGA,SAAW,CAACiE,EAAOH,EAAQD,CAAM,GAAK,CACpC,CAAC,OAAQ,WAAY,CAAC,EACtB,CAAC,QAAS,QAAS,CAAC,EACpB,CAAC,MAAO,OAAQ,CAAC,EACjB,CAAC,OAAQ,QAAS,CAAC,EACnB,CAAC,SAAU,UAAW,CAAC,EACvB,CAAC,SAAU,UAAW,CAAC,EACvB,CAAC,cAAe,eAAgB,CAAC,CACnC,EACE7D,EAAM,UAAUiE,CAAK,EAAI,SAAU7E,EAAO,CACxC,OAAOG,EAAMH,CAAK,EACd,KAAK,MAAM,CAAE,CAAC6E,CAAK,EAAG7E,CAAK,CAAE,EAC7B,KAAKwB,CAAQ,EAAE,UAAUkD,CAAM,EAAID,CACzC,EAIF7D,EAAM,UAAU,UAAY,UAAY,CACtC,MAAO,IAAM,KAAKY,CAAQ,EAAE,UAAU,KAAK,EAAI,EAAItC,GAAeA,CACpE,EAEA0B,EAAM,UAAU,UAAY,UAAY,CACtC,MAAMH,EAAO,KAAK,OAAM,EACxB,MAAO,GAAIA,EAAOA,EAAK,YAAW,CACpC,EAEAG,EAAM,UAAU,WAAa,UAAY,CACvC,MAAMH,EAAO,KAAK,OAAM,EAClBqE,EAAcrE,EAAK,IAAIA,EAAK,MAAQA,EAAK,UAAS,EAAKW,CAAQ,EAC/D2D,EAAcD,EAAY,YAAW,EACrCE,EACJD,EAAY,UAAS,IAAO3D,EACxB2D,EACAA,EAAY,IACV,GAAM3D,EAAW2D,EAAY,UAAS,EAAK7F,GAAeA,CACpE,EACE,MAAO,GAAI,KAAK,MAAM4F,EAAcE,GAAiB9F,CAAW,CAClE,EAEA0B,EAAM,UAAU,WAAa,UAAY,CACvC,MAAMH,EAAO,KAAK,OAAM,EACxB,OAAOA,EAAK,IAAIA,EAAK,IAAG,EAAKA,EAAK,UAAS,EAAKW,CAAQ,EAAE,KAAI,CAChE,EAEAR,EAAM,UAAU,WAAa,UAAY,CACvC,MAAM0D,EAAO,KAAK,KAAI,EACtB,OAAOA,EAAO,IAAM,IAAMA,EAAO,MAAQ,GAAKA,EAAO,MAAQ,EAC/D,EAEA1D,EAAM,UAAU,aAAe,UAAY,CACzC,GAAI,CAAC,KAAKY,CAAQ,EAAE,UAClB,MAAO,GAET,MAAMyD,EAAgB,KAAK,OAAM,EACjC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAE,EAChB,IAAIV,GAAS,KAAK,MAAMA,CAAK,EAAE,OAAM,CAAE,EACvC,KAAKE,GAAUA,IAAWQ,CAAa,CAC5C,EAEArE,EAAM,UAAU,QAAU,UAAY,CACpC,GAAI,CAAC,KAAKY,CAAQ,EAAE,UAClB,MAAO,GAET,MAAM0D,EAAU,MAAM,KAAK,CAAE,OAAQ,EAAE,EAAI,CAACC,EAAGC,IAC7C,KAAK,MAAMA,EAAQ,CAAC,EAAE,OAAM,CAChC,EACQC,EAAY,KAAK,IAAI,GAAGH,CAAO,EAC/BI,EAAY,KAAK,IAAI,GAAGJ,CAAO,EACrC,OAAOG,IAAcC,GAAa,KAAK,OAAM,IAAOA,CACtD,EAEA1E,EAAM,UAAU,mBAAqB,UAAY,CAC/C,OAAK,KAAKY,CAAQ,EAAE,UAGb,KAAK,iBAAmBnC,EAFtB,EAGX,EAEAuB,EAAM,UAAU,aAAe,UAAY,CACzC,GAAI,CAAC,KAAKY,CAAQ,EAAE,UAClB,OAAOnC,EAET,MAAMkG,EAAa,KAAK,QAAQ,CAAE,eAAgB,OAAO,CAAE,EAAE,WAAU,EACjE3B,EAAU2B,EAAW,KAAK,CAAE,IAAK,CAAC,CAAE,EAAE,WAAU,EACtD,OAAIA,EAAW,IAAG,IAAO3B,EAAQ,IAAG,EAC3BvE,GAEDuE,EAAU2B,GAAc7F,EAClC,EAEAkB,EAAM,UAAU,YAAc,UAAY,CACxC,MAAM4E,EAAO,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,EAAE,EACtDjB,EAAQ,KAAK,MAAK,EACxB,OAAOiB,EAAKjB,EAAQ,CAAC,GAAK,KAAK,WAAU,GAAMA,IAAU,EAAI,EAAI,EACnE,EAEA3D,EAAM,UAAU,WAAa,UAAY,CACvC,OAAO,KAAK,WAAU,EAAK,IAAM,GACnC,EAEAA,EAAM,UAAU,YAAc,UAAY,CACxC,MAAM6E,EAAY,KAAK,OAAO,CAAE,MAAO,GAAI,IAAK,EAAE,CAAE,EAC9CC,EAAgBD,EAAU,MAAM,CAAE,KAAM,CAAC,CAAE,EACjD,OACEA,EAAU,UAAS,IAAOrE,GAC1BsE,EAAc,UAAS,IAAOvE,GAEvB,GAEF,EACT,EAEA,SAAW,CAACmB,EAAMqD,CAAQ,GAAK,CAC7B,CAAC,OAAQ,CAAE,MAAO,EAAG,IAAK,EAAG,KAAM,EAAG,OAAQ,EAAG,OAAQ,EAAG,YAAa,CAAC,CAAE,EAC5E,CAAC,QAAS,CAAE,IAAK,EAAG,KAAM,EAAG,OAAQ,EAAG,OAAQ,EAAG,YAAa,CAAC,CAAE,EACnE,CAAC,OAAQ,CAAE,OAAQ,EAAG,OAAQ,EAAG,YAAa,EAAG,EACjD,CAAC,SAAU,CAAE,OAAQ,EAAG,YAAa,CAAC,CAAE,EACxC,CAAC,SAAU,CAAE,YAAa,EAAG,CAC/B,EACE/E,EAAM,UAAU,UAAU0B,CAAI,EAAE,EAAI,UAAY,CAC9C,OAAO,KAAK,MAAMqD,CAAQ,CAC5B,EAGF/E,EAAM,UAAU,WAAa,UAAY,CACvC,MAAMgF,EAAY,KAAK,MACrB,CAAE,eAAgB,OAAO,EACzB,CAAE,KAAM,EAAG,OAAQ,EAAG,OAAQ,EAAG,YAAa,CAAC,CACnD,EAAI,QAAO,EACT,OAAO,KAAK,MAAMA,CAAS,CAC7B,EAEAhF,EAAM,UAAU,OAAS,SAAUiF,EAAS,CAC1C,MAAO,CAAC,MAAS,CAACA,CACpB,EACAjF,EAAM,UAAU,SAAW,SAAUiF,EAAS,CAC5C,OAAO,KAAOA,CAChB,EACAjF,EAAM,UAAU,QAAU,SAAUiF,EAAS,CAC3C,OAAO,KAAOA,CAChB,EACAjF,EAAM,UAAU,eAAiB,SAAUiF,EAAS,CAClD,OAAO,MAAQA,CACjB,EACAjF,EAAM,UAAU,cAAgB,SAAUiF,EAAS,CACjD,OAAO,MAAQA,CACjB,EACAjF,EAAM,UAAU,UAAY,SAAUP,EAAGyF,EAAG,CAC1C,OAAQzF,GAAK,MAAQ,MAAQyF,GAAOA,GAAK,MAAQ,MAAQzF,CAC3D,EAGAO,EAAM,UAAU,KAAO,YAAaa,EAAM,CACxC,OAAOsE,GAAK,KAAK,KAAM,EAAG,GAAGtE,CAAI,CACnC,EAEAb,EAAM,UAAU,MAAQ,YAAaa,EAAM,CACzC,OAAOsE,GAAK,KAAK,KAAM,GAAI,GAAGtE,CAAI,CACpC,EAEA,SAASsE,GAAKC,KAASvE,EAAM,SAC3B,MAAMwE,EAAOxE,EAAK,CAAC,EACbyE,EAAOzE,EAAK,CAAC,EACnB,GAAI,OAAO,SAASwE,CAAI,GAAK,CAAC,OAAO,SAASC,CAAI,EAChD,OAAO,KAAK,MAAM,KAAK,QAAO,EAAKD,CAAI,EAEzC,IAAIE,EAAa,KACjB,GAAI5F,EAAS0F,CAAI,EAAG,CAClB,GAAI,CAACvF,EAAiBuF,CAAI,EACxB,MAAM,WACJ,6EAER,EAEIE,EAAaF,CACf,SAAW,OAAO,SAASA,CAAI,GAAK,MAAM,QAAQA,CAAI,EAAG,CACvD,MAAM9D,EAAOV,EAAK,KAAI,EAChBW,EAASD,EAAK,OAAOE,GAAK,OAAO,cAAcA,CAAC,CAAC,EACvD,GAAID,EAAO,SAAWD,EAAK,OACzB,MAAM,WAAW,yBAAyB,EAE5C,GAAIC,EAAO,OAAS,EAClB,MAAM,WAAW,kBAAkB,EAErC+D,EAAa,CACX,KAAM/D,EAAO,CAAC,EACd,MAAOA,EAAO,CAAC,EACf,IAAKA,EAAO,CAAC,EACb,KAAMA,EAAO,CAAC,EACd,OAAQA,EAAO,CAAC,EAChB,OAAQA,EAAO,CAAC,EAChB,YAAaA,EAAO,CAAC,CAC3B,CACE,KACE,OAAM,UAAS,EAEjB,MAAM3B,EAAO,KAAK,WAAU,EACtB2F,EAAM,KAAK5E,CAAQ,EAAE,UAAY,GAAK,MAC5C,GAAI5B,EAAIuG,EAAY,MAAM,GAAKvG,EAAIuG,EAAY,OAAO,EAAG,CACvD,MAAM7B,EAAO,KAAK,KAAI,EAAK0B,IAAQ9D,EAAAiE,EAAW,OAAX,KAAAjE,EAAmB,GAChDqC,EAAQ,KAAK,MAAK,EAAKyB,IAAQvD,EAAA0D,EAAW,QAAX,KAAA1D,EAAoB,GACnD4D,EAAa,IAAI,KAAK5F,EAAK,QAAO,CAAE,EAC1C4F,EAAW,MAAMD,CAAG,UAAU,EAAE9B,EAAMC,EAAO,CAAC,EAC9C,MAAM+B,EAAUD,EAAW,MAAMD,CAAG,MAAM,EAAC,EACvCE,EAAU,KAAK,MACjB7F,EAAK,MAAM2F,CAAG,UAAU,EAAE9B,EAAM+B,EAAW,MAAMD,CAAG,OAAO,EAAC,EAAIE,CAAO,EAEvE7F,EAAK,MAAM2F,CAAG,UAAU,EAAE9B,EAAMC,EAAQ,CAAC,CAE7C,CACI3E,EAAIuG,EAAY,KAAK,GACvB1F,EAAK,MAAM2F,CAAG,MAAM,EAAE3F,EAAK,MAAM2F,CAAG,MAAM,EAAC,EAAKJ,EAAOG,EAAW,GAAG,EAEvE,SAAW,CAACjG,EAAKqG,CAAS,GAAK,CAC7B,CAAC,OAAQ,OAAO,EAChB,CAAC,SAAU,SAAS,EACpB,CAAC,SAAU,SAAS,EACpB,CAAC,cAAe,cAAc,CAClC,EACQ,CAAC3G,EAAIuG,EAAYjG,CAAG,GAAKiG,EAAWjG,CAAG,GAAK,MAGhDO,EAAK,SAAS8F,CAAS,EAAE,EACvB9F,EAAK,SAAS8F,CAAS,EAAE,IAAMP,EAAOG,EAAWjG,CAAG,CAC1D,EAEE,OAAO,KAAK,MAAMO,CAAI,CACxB,CAKA,MAAM+F,EAAe,OAAM,EAE3B,SAAS3F,KAAaY,EAAM,CAC1B,GAAI,CAAC,WACH,OAAO,IAAIZ,EAAU,GAAGY,CAAI,EAE9B,MAAMC,EAAO,CAAE,SAAU,IAAI,EAC7B,KAAK8E,CAAY,EAAI9E,EACrB,IAAIK,EAAS,KACTN,EAAK,CAAC,YAAaZ,EACrBkB,EAASN,EAAK,MAAK,EAAG,WAAU,EACvBA,EAAK,CAAC,YAAab,IAC5BmB,EAASN,EAAK,MAAK,GAErB,MAAMO,EAAQP,EAAK,CAAC,EACdQ,EAASR,EAAK,CAAC,EACrB,OAAI,OAAO,SAASO,CAAK,GAAK,CAAC,OAAO,SAASC,CAAM,IACnDR,EAAK,CAAC,EAAI,KAAK,MAAMO,CAAK,EAAIrC,GAE5BoC,EACFA,EAASA,EAAO,MAAM,GAAGN,CAAI,EAE7BM,EAASpB,EAAM,GAAGc,CAAI,EAExBC,EAAK,SAAWK,EAAO,WAAU,EAC1B,IACT,CAEAlB,EAAU,UAAU,SAAW,UAAY,CACzC,OAAO,KAAK2F,CAAY,EAAE,SAAS,WAAW,UAAU,EAAG,EAAE,CAC/D,EAEA3F,EAAU,UAAU,QAAU,UAAY,CACxC,OAAO,KAAK2F,CAAY,EAAE,SAAW7G,CACvC,EAEAkB,EAAU,UAAU,MAAQ,UAAY,CACtC,OAAO,KAAK2F,CAAY,EAAE,SAAS,MAAK,CAC1C,EAEA3F,EAAU,UAAU,MAAQ,YAAaY,EAAM,CAC7C,OAAO,IAAIZ,EAAU,KAAM,GAAGY,CAAI,CACpC,EAEAZ,EAAU,UAAU,WAAa,UAAY,CAC3C,OAAOF,EAAM,KAAK6F,CAAY,EAAE,SAAS,QAAO,CAAE,CACpD,EAEA3F,EAAU,UAAU,QAAU,UAAY,CACxC,OAAO,KAAK2F,CAAY,EAAE,SAAS,QAAO,EAAK7G,CACjD,EAEAkB,EAAU,UAAU,SAAW,UAAY,CACzC,MAAO,CACL,KAAM,KAAK,KAAI,EACf,MAAO,KAAK,MAAK,EACjB,IAAK,KAAK,IAAG,CACjB,CACA,EAEAA,EAAU,UAAU,QAAU,UAAY,CACxC,MAAO,CAAC,KAAK,KAAI,EAAI,KAAK,MAAK,EAAI,KAAK,IAAG,CAAE,CAC/C,EAEAA,EAAU,UAAU,YAAc,UAAY,CAC5C,OAAO,IAAIA,EAAU,KAAK2F,CAAY,EAAE,SAAS,YAAW,CAAE,CAChE,EAEA3F,EAAU,UAAU,aAAe,UAAY,CAC7C,OAAO,IAAIA,EAAU,KAAK2F,CAAY,EAAE,SAAS,aAAY,CAAE,CACjE,EAEA3F,EAAU,UAAU,WAAa,UAAY,CAC3C,OAAO,KAAK2F,CAAY,EAAE,SAAS,MAAK,CAC1C,EACA,UAAW3B,IAAS,CAAC,OAAQ,QAAS,KAAK,EACzChE,EAAU,UAAUgE,CAAK,EAAI,SAAU7E,EAAO,CAC5C,OAAIG,EAAMH,CAAK,EACN,IAAIa,EAAU,KAAK2F,CAAY,EAAE,SAAS3B,CAAK,EAAE7E,CAAK,CAAC,EAEzD,KAAKwG,CAAY,EAAE,SAAS3B,CAAK,EAAC,CAC3C,EAEF,UAAW4B,IAAU,CACnB,YACA,YACA,aACA,aACA,aACA,cACA,aACA,aACF,EACE5F,EAAU,UAAU4F,CAAM,EAAI,UAAY,CACxC,OAAO,KAAKD,CAAY,EAAE,SAASC,CAAM,EAAC,CAC5C,EAEF,UAAWA,IAAU,CAAC,eAAgB,eAAgB,oBAAoB,EACxE5F,EAAU,UAAU4F,CAAM,EAAI,UAAY,CACxC,OAAO9F,EACL,CAAE,eAAgB,OAAO,EACzB,KAAK6F,CAAY,EAAE,SAAS,QAAO,EAAG,MAAM,EAAG,CAAC,CACtD,EAAMC,CAAM,EAAC,CACX,EAGF5F,EAAU,UAAU,UAAY,UAAY,CAC1C,OAAO,KAAK,MAAM,CAAE,MAAO,GAAI,IAAK,EAAE,CAAE,CAC1C,EAEAA,EAAU,UAAU,WAAa,UAAY,CAC3C,OAAO,KAAK,MAAM,CAAE,IAAK,KAAK,YAAW,CAAE,CAAE,CAC/C,EAEAA,EAAU,UAAU,OAAS,SAAUgF,EAAS,CAC9C,MAAO,CAAC,MAAS,CAACA,CACpB,EACAhF,EAAU,UAAU,SAAW,SAAUgF,EAAS,CAChD,OAAO,KAAOA,CAChB,EACAhF,EAAU,UAAU,QAAU,SAAUgF,EAAS,CAC/C,OAAO,KAAOA,CAChB,EACAhF,EAAU,UAAU,eAAiB,SAAUgF,EAAS,CACtD,OAAO,MAAQA,CACjB,EACAhF,EAAU,UAAU,cAAgB,SAAUgF,EAAS,CACrD,OAAO,MAAQA,CACjB,EACAhF,EAAU,UAAU,UAAY,SAAUR,EAAGyF,EAAG,CAC9C,OAAQzF,GAAK,MAAQ,MAAQyF,GAAOA,GAAK,MAAQ,MAAQzF,CAC3D,EAEAQ,EAAU,UAAU,KAAO,YAAaY,EAAM,CAC5C,OAAOiF,GAAS,KAAK,KAAM,EAAG,GAAGjF,CAAI,CACvC,EAEAZ,EAAU,UAAU,MAAQ,YAAaY,EAAM,CAC7C,OAAOiF,GAAS,KAAK,KAAM,GAAI,GAAGjF,CAAI,CACxC,EAEA,SAASiF,GAASV,KAASvE,EAAM,WAC/B,MAAMwE,EAAOxE,EAAK,CAAC,EACbyE,EAAOzE,EAAK,CAAC,EACbkF,EAAW,KAAKH,CAAY,EAAE,SACpC,GAAI,OAAO,SAASP,CAAI,GAAK,CAAC,OAAO,SAASC,CAAI,EAChD,OAAOS,EAAS,KAAK,CAAE,IAAKX,EAAOC,CAAI,CAAE,EAAE,OAAM,EAEnD,IAAIE,EAAa,KACjB,GAAI5F,EAAS0F,CAAI,GAAKvF,EAAiBuF,CAAI,EACzCE,EAAa,CACX,KAAMH,IAAQ9D,EAAA+D,EAAK,OAAL,KAAA/D,EAAa,GAC3B,MAAO8D,IAAQvD,EAAAwD,EAAK,QAAL,KAAAxD,EAAc,GAC7B,IAAKuD,IAAQtD,EAAAuD,EAAK,MAAL,KAAAvD,EAAY,EAC/B,UACa,OAAO,SAASuD,CAAI,EAAG,CAChC,GAAIxE,EAAK,OAAS,EAChB,MAAM,WAAW,oBAAoB,EAEvC0E,EAAa,CAAE,KAAMH,EAAOC,EAAM,MAAOD,EAAOE,EAAM,IAAKF,EAAO,IAAI,CACxE,SAAW,MAAM,QAAQC,CAAI,EAAG,CAC9B,GAAIA,EAAK,OAAS,EAChB,MAAM,WAAW,mBAAmB,EAEtCE,EAAa,CACX,KAAMH,EAAOC,EAAK,CAAC,EACnB,MAAOD,EAAOC,EAAK,CAAC,EACpB,IAAKD,EAAOC,EAAK,CAAC,CACxB,CACE,KACE,OAAM,UAAS,EAEjB,OAAOU,EAAS,KAAKR,CAAU,EAAE,OAAM,CACzC"}
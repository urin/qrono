{"version":3,"file":"qrono.js","sources":["../src/helpers.js","../src/qrono.js"],"sourcesContent":["export const epoch = new Date(0)\n\n// When creating or updating a local time, both `Date.setFullYear` and `Date.setHours` are used.\n// Noon is used as the initial reference point to avoid the time after `setFullYear`\n// from falling into an ambiguous DST period. Historically, DST transitions in all countries\n// have been scheduled around midnight, and it should be the same in the future.\n// The reason for selecting 1915 as the initial value is as follows.\n// Since DST was first established in 1916, the initial value should be set to a year prior to that.\n// If a year too far in the past is chosen, it may correspond to a period when time zones were not yet\n// precisely defined in some regions, which could result in unexpected timezone offsets.\nexport const initialSafeDate = new Date(1915, 0, 1, 12, 0, 0, 0)\n\nexport const daysPerWeek = 7\nexport const hoursPerDay = 24\nexport const hoursPerWeek = hoursPerDay * daysPerWeek\nexport const minutesPerHour = 60\nexport const minutesPerDay = minutesPerHour * hoursPerDay\nexport const minutesPerWeek = minutesPerDay * daysPerWeek\nexport const secondsPerMinute = 60\nexport const secondsPerHour = secondsPerMinute * minutesPerHour\nexport const secondsPerDay = secondsPerHour * hoursPerDay\nexport const secondsPerWeek = secondsPerDay * daysPerWeek\nexport const millisecondsPerSecond = 1000\nexport const millisecondsPerMinute = secondsPerMinute * millisecondsPerSecond\nexport const millisecondsPerHour = secondsPerHour * millisecondsPerSecond\nexport const millisecondsPerDay = secondsPerDay * millisecondsPerSecond\nexport const millisecondsPerWeek = secondsPerWeek * millisecondsPerSecond\n\nexport const monday = 1\nexport const tuesday = 2\nexport const wednesday = 3\nexport const thursday = 4\nexport const friday = 5\nexport const saturday = 6\nexport const sunday = 7\n\nexport function has (object, ...keys) {\n  return keys.flat().some(object.hasOwnProperty, object)\n}\n\nexport function fields (object) {\n  return Object.entries(object).filter(\n    ([, value]) => !isFunction(value)\n  ).map(([key]) => key)\n}\n\nexport function given (arg) {\n  return arg !== undefined\n}\n\nexport function isFunction (a) {\n  return a instanceof Function\n}\n\nexport function isString (a) {\n  return typeof a === 'string' || a instanceof String\n}\n\nexport function isObject (a) {\n  return a !== null && typeof (a) === 'object' && a.constructor === Object\n}\n\nexport function isValidDate (date) {\n  return !isNaN(date.getTime())\n}\n\nexport function hasDateField (object) {\n  return has(object, ['year', 'month', 'day'])\n}\n\nexport function hasTimeField (object) {\n  return has(object, ['hour', 'minute', 'second', 'millisecond'])\n}\n\nexport function hasDatetimeField (object) {\n  return has(object, [\n    'year', 'month', 'day', 'hour', 'minute', 'second', 'millisecond'\n  ])\n}\n\nexport function asDst (ambiguousAsDst, date) {\n  const numeric = date.getTime()\n  const result = new Date(numeric)\n  const adjacentDay = new Date(numeric)\n  const sign = ambiguousAsDst ? 1 : -1\n  adjacentDay.setDate(date.getDate() + sign)\n  const adjust = adjacentDay.getTimezoneOffset() - date.getTimezoneOffset()\n  if ((ambiguousAsDst && adjust < 0) || (!ambiguousAsDst && adjust > 0)) {\n    const adjusted = new Date(numeric).setMinutes(date.getMinutes() + sign * adjust)\n    const adjustedUTC = new Date(numeric).setUTCMinutes(date.getUTCMinutes() + sign * adjust)\n    if (adjusted !== adjustedUTC && (adjusted - adjustedUTC) / millisecondsPerMinute !== adjust) {\n      result.setUTCMinutes(date.getUTCMinutes() + sign * adjust)\n    }\n  }\n  return result\n}\n","/* @ts-self-types=\"../types/qrono.d.ts\" */\nimport {\n  has,\n  given,\n  fields,\n  isObject,\n  isString,\n  isValidDate,\n  asDst,\n  hasDatetimeField,\n  initialSafeDate,\n  daysPerWeek,\n  minutesPerDay,\n  minutesPerHour,\n  millisecondsPerMinute,\n  millisecondsPerDay,\n  monday,\n  tuesday,\n  wednesday,\n  thursday,\n  friday,\n  saturday,\n  sunday\n} from './helpers.js'\n\n// -----------------------------------------------------------------------------\n// Exports\n// -----------------------------------------------------------------------------\nconst qrono = Qrono\n\nexport { qrono }\n\nexport {\n  monday,\n  tuesday,\n  wednesday,\n  thursday,\n  friday,\n  saturday,\n  sunday\n} from './helpers'\n\n// -----------------------------------------------------------------------------\n// Static\n// -----------------------------------------------------------------------------\nQrono.date = QronoDate\n\n// NOTE Must be flat object for shallow cloning.\nconst defaultContext = {\n  localtime: false,\n  ambiguousAsDst: false\n}\n\nfields(defaultContext).forEach(key => {\n  Qrono[key] = function (arg) {\n    if (given(arg)) {\n      defaultContext[key] = arg\n      return this\n    }\n    return defaultContext[key]\n  }\n})\n\nQrono.context = function (context) {\n  if (given(context)) {\n    fields(defaultContext).filter(key => has(context, key)).forEach(key => {\n      defaultContext[key] = context[key]\n    })\n    return this\n  }\n  return { ...defaultContext }\n}\n\nQrono.asUtc = function () {\n  defaultContext.localtime = false\n  return this\n}\n\nQrono.asLocaltime = function () {\n  defaultContext.localtime = true\n  return this\n}\n\nObject.assign(\n  Qrono,\n  { monday, tuesday, wednesday, thursday, friday, saturday, sunday }\n)\n\n// -----------------------------------------------------------------------------\n// Constructor\n// -----------------------------------------------------------------------------\nconst internal = Symbol('Qrono.internal')\n\nfunction Qrono (...args) {\n  if (!new.target) { return new Qrono(...args) }\n  const self = this[internal] = {\n    // properties\n    nativeDate: null,\n    localtime: false,\n    ambiguousAsDst: false,\n    // methods\n    set,\n    parse,\n    valid,\n    context,\n    getNative\n  }\n\n  // Construction\n  self.context(defaultContext)\n  if (args[0] instanceof Qrono) {\n    const source = args.shift()\n    fields(self).forEach(key => { self[key] = source[key]() })\n  }\n  if (isObject(args[0]) && !hasDatetimeField(args[0])) {\n    self.context(args.shift())\n  }\n  const first = args[0]\n  const second = args[1]\n  if (first == null) {\n    self.nativeDate ??= new Date()\n  } else if (first instanceof Date) {\n    self.nativeDate = new Date(first.getTime())\n  } else if (isString(first)) {\n    self.parse(first)\n  } else if (isObject(first)) {\n    if (!hasDatetimeField(first)) {\n      throw RangeError('Missing time field' +\n        ' (year, minute, day, hour, minute, second or millisecond)'\n      )\n    }\n    self.set(first)\n  } else if (Number.isFinite(first) && !Number.isFinite(second)) {\n    self.nativeDate = new Date(first)\n  } else if (Number.isFinite(first) || Array.isArray(first)) {\n    const values = args.flat().filter(v => Number.isSafeInteger(v))\n    if (values.length !== args.flat().length) {\n      throw RangeError('Should be safe integers')\n    }\n    if (values.length > 7) {\n      throw RangeError('Too many numbers')\n    }\n    self.set({\n      year: values[0],\n      month: values[1],\n      day: values[2],\n      hour: values[3],\n      minute: values[4],\n      second: values[5],\n      millisecond: values[6]\n    })\n  } else {\n    throw TypeError(`Invalid argument ${args}`)\n  }\n  return this\n}\n\n// -----------------------------------------------------------------------------\n// Private methods\n// -----------------------------------------------------------------------------\nfunction valid () {\n  return isValidDate(this.nativeDate)\n}\n\nfunction context (context) {\n  if (!context) { return }\n  fields(defaultContext).filter(key => has(context, key)).forEach(key => {\n    this[key] = context[key]\n  })\n  return this\n}\n\nfunction getNative (name) {\n  return this.nativeDate[`get${this.localtime ? '' : 'UTC'}${name}`]()\n}\n\nfunction set (values) {\n  const args = { ...values }\n  args.month = args.month && args.month - 1\n  if (this.localtime) {\n    const baseDate = this.nativeDate ?? new Date(0, 0)\n    const newDate = new Date(initialSafeDate.getTime())\n    newDate.setFullYear(\n      args.year ?? baseDate.getFullYear(),\n      args.month ?? baseDate.getMonth(),\n      args.day ?? baseDate.getDate()\n    )\n    newDate.setHours(\n      args.hour ?? baseDate.getHours(),\n      args.minute ?? baseDate.getMinutes(),\n      args.second ?? baseDate.getSeconds(),\n      args.millisecond ?? baseDate.getMilliseconds()\n    )\n    this.nativeDate = asDst(this.ambiguousAsDst, newDate)\n  } else {\n    const baseDate = this.nativeDate ?? new Date(0)\n    const newDate = new Date(0)\n    newDate.setUTCFullYear(\n      args.year ?? baseDate.getUTCFullYear(),\n      args.month ?? baseDate.getUTCMonth(),\n      args.day ?? baseDate.getUTCDate()\n    )\n    newDate.setUTCHours(\n      args.hour ?? baseDate.getUTCHours(),\n      args.minute ?? baseDate.getUTCMinutes(),\n      args.second ?? baseDate.getUTCSeconds(),\n      args.millisecond ?? baseDate.getUTCMilliseconds()\n    )\n    this.nativeDate = newDate\n  }\n  return this\n}\n\nconst parsePattern = new RegExp(\n  // yyyy[[-|/]MM[[-|/]DD]]\n  '^(\\\\d{4})(?:[-/]?([0-2]?\\\\d)(?:[-/]?([0-3]?\\\\d))?)?' +\n  // [(T| )HH[:]mm[[:]ss[(.|:)SSS]]]\n  '(?:[T\\\\s]([0-2]?\\\\d)(?::([0-5]?\\\\d)?(?::([0-6]?\\\\d)?(?:[.:](\\\\d{1,3})?\\\\d*)?)?)?)?' +\n  // [Z|(+|-)hh:mm]\n  '(Z|[-+]\\\\d{2}:?\\\\d{2})?$'\n)\n\nfunction parse (str) {\n  const text = str.trim().toUpperCase()\n  const values = text.match(parsePattern)\n  if (!values) {\n    throw RangeError(\n      `Failed to parse '${str}'.` +\n      ' Should be yyyy[[-|/]MM[[-|/]DD]][(T| )HH:mm[:ss[(.|:)SSS]]][Z|(+|-)hh:mm]'\n    )\n  }\n  const [year, month, day, hour, minute, second, millisecond, offset] = [\n    +values[1], +values[2] || 1, +values[3] || 1,\n    +values[4] || 0, +values[5] || 0, +values[6] || 0,\n    +values[7]?.padStart(3, '0') || 0,\n    values[8]\n  ]\n  const native = new Date(text)\n  if (!isValidDate(native)) {\n    throw RangeError(\n      `Failed to parse '${str}' by Date.` +\n      ' Should be yyyy[[-|/]MM[[-|/]DD]][(T| )HH:mm[:ss[(.|:)SSS]]][Z|(+|-)hh:mm]'\n    )\n  }\n  if (offset) {\n    this.nativeDate = native\n  } else if (this.localtime) {\n    this.nativeDate = asDst(this.ambiguousAsDst, native)\n  } else {\n    this.set({ year, month, day, hour, minute, second, millisecond })\n  }\n  return this\n}\n\n// -----------------------------------------------------------------------------\n// Public methods\n// -----------------------------------------------------------------------------\n// Basic\nQrono.prototype.toString = function () {\n  if (this[internal].localtime) {\n    const t = this[internal].nativeDate\n    const offset = -t.getTimezoneOffset()\n    const offsetAbs = Math.abs(offset)\n    return `${String(t.getFullYear()).padStart(4, '0')\n      }-${String(t.getMonth() + 1).padStart(2, '0')\n      }-${String(t.getDate()).padStart(2, '0')\n      }T${String(t.getHours()).padStart(2, '0')\n      }:${String(t.getMinutes()).padStart(2, '0')\n      }:${String(t.getSeconds()).padStart(2, '0')\n      }.${String(t.getMilliseconds()).padStart(3, '0')\n      }${(offset >= 0 ? '+' : '-') +\n      String(Math.trunc(offsetAbs / minutesPerHour)).padStart(2, '0') +\n      ':' + String(offsetAbs % minutesPerHour).padStart(2, '0')\n      }`\n  }\n  return this[internal].nativeDate.toISOString()\n}\n\nQrono.prototype.valueOf = function () {\n  return this[internal].nativeDate.valueOf()\n}\n\nQrono.prototype.clone = function (...args) {\n  return new Qrono(this, ...args)\n}\n\nQrono.prototype.context = function (context) {\n  return given(context)\n    ? this.clone(context)\n    : { localtime: this[internal].localtime, ambiguousAsDst: this[internal].ambiguousAsDst }\n}\n\nQrono.prototype.nativeDate = function () {\n  return new Date(this[internal].nativeDate.getTime())\n}\n\nQrono.prototype.offset = function () {\n  return (\n    this[internal].localtime ? -this[internal].nativeDate.getTimezoneOffset() : 0\n  )\n}\n\nQrono.prototype.localtime = function (arg) {\n  return given(arg) ? this.clone({ localtime: arg }) : this[internal].localtime\n}\n\nQrono.prototype.ambiguousAsDst = function (arg) {\n  return given(arg) ? this.clone({ ambiguousAsDst: arg }) : this[internal].ambiguousAsDst\n}\n\nQrono.prototype.valid = function () {\n  return this[internal].valid()\n}\n\n// Transform\nQrono.prototype.numeric = function () {\n  return this[internal].nativeDate.getTime()\n}\n\nQrono.prototype.toObject = function () {\n  return {\n    year: this.year(),\n    month: this.month(),\n    day: this.day(),\n    hour: this.hour(),\n    minute: this.minute(),\n    second: this.second(),\n    millisecond: this.millisecond()\n  }\n}\n\nQrono.prototype.toArray = function () {\n  return [\n    this.year(),\n    this.month(),\n    this.day(),\n    this.hour(),\n    this.minute(),\n    this.second(),\n    this.millisecond()\n  ]\n}\n\nQrono.prototype.toDate = function (...args) {\n  return new QronoDate(this.clone(...args))\n}\n\n// Context\nQrono.prototype.asUtc = function () {\n  return this.clone({ localtime: false })\n}\n\nQrono.prototype.asLocaltime = function () {\n  return this.clone({ localtime: true })\n}\n\n// Accessor\nQrono.prototype.year = function (value) {\n  return given(value)\n    ? this.clone({ year: value })\n    : this[internal].getNative('FullYear')\n}\n\nQrono.prototype.month = function (value) {\n  return given(value)\n    ? this.clone({ month: value })\n    : this[internal].getNative('Month') + 1\n}\n\nQrono.prototype.day = function (value) {\n  return given(value)\n    ? this.clone({ day: value })\n    : this[internal].getNative('Date')\n}\n\nQrono.prototype.hour = function (value) {\n  return given(value)\n    ? this.clone({ hour: value })\n    : this[internal].getNative('Hours')\n}\n\nQrono.prototype.minute = function (value) {\n  return given(value)\n    ? this.clone({ minute: value })\n    : this[internal].getNative('Minutes')\n}\n\nQrono.prototype.second = function (value) {\n  return given(value)\n    ? this.clone({ second: value })\n    : this[internal].getNative('Seconds')\n}\n\nQrono.prototype.millisecond = function (value) {\n  return given(value)\n    ? this.clone({ millisecond: value })\n    : this[internal].getNative('Milliseconds')\n}\n\n// Getter\nQrono.prototype.dayOfWeek = function () {\n  return (\n    1 + (this[internal].getNative('Day') - 1 + daysPerWeek) % daysPerWeek\n  )\n}\n\nQrono.prototype.dayOfYear = function () {\n  const date = this.toDate()\n  return 1 + date - date.startOfYear()\n}\n\nQrono.prototype.weekOfYear = function () {\n  const date = this.toDate()\n  const theThursday = date.day(date.day() - date.dayOfWeek() + thursday)\n  const startOfYear = theThursday.startOfYear()\n  const firstThursday = (startOfYear.dayOfWeek() === thursday)\n    ? startOfYear\n    : startOfYear.day(\n      1 + ((thursday - startOfYear.dayOfWeek() + daysPerWeek) % daysPerWeek)\n    )\n  return 1 + Math.ceil((theThursday - firstThursday) / daysPerWeek)\n}\n\nQrono.prototype.yearOfWeek = function () {\n  const date = this.toDate()\n  return date.day(date.day() - date.dayOfWeek() + thursday).year()\n}\n\nQrono.prototype.isLeapYear = function () {\n  const year = this.year()\n  return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)\n}\n\nQrono.prototype.hasDstInYear = function () {\n  if (!this[internal].localtime) { return false }\n  const currentOffset = this.offset()\n  return [3, 6, 9, 12].map(\n    month => this.month(month).offset()\n  ).some(offset => offset !== currentOffset)\n}\n\nQrono.prototype.isInDst = function () {\n  if (!this[internal].localtime) { return false }\n  return (\n    this.offset() ===\n    Math.max(...[3, 6, 9, 12].map(month => this.month(month).offset()))\n  )\n}\n\nQrono.prototype.isDstTransitionDay = function () {\n  if (!this[internal].localtime) { return false }\n  return this.minutesInDay() !== minutesPerDay\n}\n\nQrono.prototype.minutesInDay = function () {\n  if (!this[internal].localtime) { return minutesPerDay }\n  const startOfDay = this.startOfDay()\n  const nextDay = startOfDay.plus({ day: 1 }).startOfDay()\n  if (startOfDay.day() === nextDay.day()) {\n    return minutesPerDay\n  }\n  return (nextDay - startOfDay) / millisecondsPerMinute\n}\n\nQrono.prototype.daysInMonth = function () {\n  const days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\n  const month = this.month()\n  return days[month - 1] + (this.isLeapYear() && month === 2 ? 1 : 0)\n}\n\nQrono.prototype.daysInYear = function () {\n  return this.isLeapYear() ? 366 : 365\n}\n\nQrono.prototype.weeksInYear = function () {\n  const endOfYear = this.toDate({ month: 12, day: 31 })\n  const endOfLastYear = endOfYear.minus({ year: 1 })\n  if (endOfYear.dayOfWeek() === thursday || endOfLastYear.dayOfWeek() === wednesday) {\n    return 53\n  }\n  return 52\n}\n\nQrono.prototype.startOfYear = function () {\n  return this.clone({\n    month: 1, day: 1, hour: 0, minute: 0, second: 0, millisecond: 0\n  })\n}\n\nQrono.prototype.startOfMonth = function () {\n  return this.clone({\n    day: 1, hour: 0, minute: 0, second: 0, millisecond: 0\n  })\n}\n\nQrono.prototype.startOfDay = function () {\n  return this.clone({\n    hour: 0, minute: 0, second: 0, millisecond: 0\n  })\n}\n\nQrono.prototype.startOfHour = function () {\n  return this.clone({\n    minute: 0, second: 0, millisecond: 0\n  })\n}\n\nQrono.prototype.startOfMinute = function () {\n  return this.clone({\n    second: 0, millisecond: 0\n  })\n}\n\nQrono.prototype.startOfSecond = function () {\n  return this.clone({\n    millisecond: 0\n  })\n}\n\nQrono.prototype.isSame = function (another) { return +this === +another }\nQrono.prototype.isBefore = function (another) { return this < another }\nQrono.prototype.isAfter = function (another) { return this > another }\nQrono.prototype.isSameOrBefore = function (another) { return this <= another }\nQrono.prototype.isSameOrAfter = function (another) { return this >= another }\nQrono.prototype.isBetween = function (a, b) {\n  return (a <= this && this <= b) || (b <= this && this <= a)\n}\n\n// Calculation\nQrono.prototype.plus = function (...args) {\n  return plus.call(this, 1, ...args)\n}\n\nQrono.prototype.minus = function (...args) {\n  return plus.call(this, -1, ...args)\n}\n\nfunction plus (sign, ...args) {\n  const arg0 = args[0]\n  const arg1 = args[1]\n  if (Number.isFinite(arg0) && !Number.isFinite(arg1)) {\n    return this.clone(this.numeric() + arg0)\n  }\n  let timeFields = null\n  if (isObject(arg0)) {\n    if (!hasDatetimeField(arg0)) {\n      throw RangeError('Missing time field' +\n        ' (year, minute, day, hour, minute, second or millisecond)'\n      )\n    }\n    timeFields = arg0\n  } else if (Number.isFinite(arg0) || Array.isArray(arg0)) {\n    const values = args.flat().filter(v => Number.isSafeInteger(v))\n    if (values.length !== args.flat().length) {\n      throw RangeError('Should be safe integers')\n    }\n    if (values.length > 7) {\n      throw RangeError('Too many numbers')\n    }\n    timeFields = {\n      year: args[0],\n      month: args[1],\n      day: args[2],\n      hour: args[3],\n      minute: args[4],\n      second: args[5],\n      millisecond: args[6]\n    }\n  } else {\n    throw TypeError()\n  }\n  const date = this.nativeDate()\n  const utc = this[internal].localtime ? '' : 'UTC'\n  if (has(timeFields, 'year') || has(timeFields, 'month')) {\n    const year = this.year() + sign * (timeFields.year ?? 0)\n    const month = this.month() + sign * (timeFields.month ?? 0)\n    const endOfMonth = new Date(date.getTime())\n    endOfMonth[`set${utc}FullYear`](year, month, 0)\n    const lastDay = endOfMonth.getDate()\n    if (lastDay < this.day()) {\n      date[`set${utc}FullYear`](year, endOfMonth[`get${utc}Month`](), lastDay)\n    } else {\n      date[`set${utc}FullYear`](year, month - 1)\n    }\n  }\n  if (has(timeFields, 'day')) {\n    date[`set${utc}Date`](date[`get${utc}Date`]() + sign * timeFields.day)\n  }\n  [\n    ['hour', 'Hours'], ['minute', 'Minutes'],\n    ['second', 'Seconds'], ['millisecond', 'Milliseconds']\n  ].forEach(([key, nativeKey]) => {\n    if (has(timeFields, key)) {\n      date[`setUTC${nativeKey}`](\n        date[`getUTC${nativeKey}`]() + sign * timeFields[key]\n      )\n    }\n  })\n  return this.clone(asDst(this[internal].ambiguousAsDst, date))\n}\n\n// -----------------------------------------------------------------------------\n// QronoDate Class\n// -----------------------------------------------------------------------------\nconst internalDate = Symbol('QronoDate.internal')\n\nfunction QronoDate (...args) {\n  if (!new.target) { return new QronoDate(...args) }\n  const self = this[internalDate] = {\n    datetime: null\n  }\n  let source = null\n  if (args[0] instanceof QronoDate) {\n    source = args.shift().toDatetime()\n  }\n  const first = args[0]\n  const second = args[1]\n  if (Number.isFinite(first) && !Number.isFinite(second)) {\n    args[0] *= millisecondsPerDay\n  }\n  source = (\n    source ? source.clone(...args) : qrono(...args)\n  ).startOfDay()\n  self.datetime = qrono({ localtime: false }, source.toObject())\n  return this\n}\n\nQronoDate.prototype.toString = function () {\n  return this[internalDate].datetime.toString().substring(0, 10)\n}\n\nQronoDate.prototype.valueOf = function () {\n  return this[internalDate].datetime / millisecondsPerDay\n}\n\nQronoDate.prototype.valid = function () {\n  return this[internalDate].datetime.valid()\n}\n\nQronoDate.prototype.clone = function (...args) {\n  return new QronoDate(this, ...args)\n}\n\nQronoDate.prototype.toDatetime = function () {\n  return qrono(this[internalDate].datetime.toArray())\n}\n\nQronoDate.prototype.numeric = function () {\n  return this[internalDate].datetime.numeric() / millisecondsPerDay\n}\n\nQronoDate.prototype.toObject = function () {\n  return {\n    year: this.year(),\n    month: this.month(),\n    day: this.day()\n  }\n}\n\nQronoDate.prototype.toArray = function () {\n  return [this.year(), this.month(), this.day()]\n}\n\nQronoDate.prototype.startOfYear = function () {\n  return new QronoDate(this[internalDate].datetime.startOfYear())\n}\n\nQronoDate.prototype.startOfMonth = function () {\n  return new QronoDate(this[internalDate].datetime.startOfMonth())\n}\n\nQronoDate.prototype.startOfDay = function () {\n  return this[internalDate].datetime.clone()\n}\n\n;['year', 'month', 'day'].forEach(field => {\n  QronoDate.prototype[field] = function (value) {\n    if (given(value)) {\n      return new QronoDate(this[internalDate].datetime[field](value))\n    }\n    return this[internalDate].datetime[field]()\n  }\n})\n\n;[\n  'dayOfWeek', 'dayOfYear', 'weekOfYear', 'yearOfWeek',\n  'isLeapYear', 'daysInMonth', 'daysInYear', 'weeksInYear'\n].forEach(method => {\n  QronoDate.prototype[method] = function () {\n    return this[internalDate].datetime[method]()\n  }\n})\n\n;[\n  'minutesInDay', 'hasDstInYear', 'isDstTransitionDay'\n].forEach(method => {\n  QronoDate.prototype[method] = function () {\n    return this[internalDate].datetime.localtime(true)[method]()\n  }\n})\n\nQronoDate.prototype.endOfYear = function () {\n  return this.clone({ month: 12, day: 31 })\n}\n\nQronoDate.prototype.endOfMonth = function () {\n  return this.clone({ day: this.daysInMonth() })\n}\n\nQronoDate.prototype.isSame = function (another) { return +this === +another }\nQronoDate.prototype.isBefore = function (another) { return this < another }\nQronoDate.prototype.isAfter = function (another) { return this > another }\nQronoDate.prototype.isSameOrBefore = function (another) { return this <= another }\nQronoDate.prototype.isSameOrAfter = function (another) { return this >= another }\nQronoDate.prototype.isBetween = function (a, b) {\n  return (a <= this && this <= b) || (b <= this && this <= a)\n}\n\nQronoDate.prototype.plus = function (...args) {\n  return this[internalDate].datetime.plus(...args).toDate()\n}\n\nQronoDate.prototype.minus = function (...args) {\n  return this[internalDate].datetime.minus(...args).toDate()\n}\n"],"names":["initialSafeDate","daysPerWeek","hoursPerDay","minutesPerHour","minutesPerDay","secondsPerMinute","secondsPerHour","secondsPerDay","millisecondsPerSecond","millisecondsPerMinute","millisecondsPerDay","monday","tuesday","wednesday","thursday","friday","saturday","sunday","has","object","keys","fields","value","isFunction","key","given","arg","a","isString","isObject","isValidDate","date","hasDatetimeField","asDst","ambiguousAsDst","numeric","result","adjacentDay","sign","adjust","adjusted","adjustedUTC","qrono","Qrono","QronoDate","defaultContext","context","__spreadValues","internal","args","_a","self","set","parse","valid","getNative","source","first","second","values","v","name","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","_m","_n","_o","_p","baseDate","newDate","parsePattern","str","text","year","month","day","hour","minute","millisecond","offset","native","offsetAbs","theThursday","startOfYear","firstThursday","currentOffset","startOfDay","nextDay","days","endOfYear","endOfLastYear","another","b","plus","arg0","arg1","timeFields","utc","endOfMonth","lastDay","nativeKey","internalDate","field","method"],"mappings":"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"}
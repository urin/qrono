{"version":3,"file":"qrono.js","sources":["../src/helpers.js","../src/qrono.js"],"sourcesContent":["export const epoch = new Date(0)\n\n/**\n * When creating or updating a local time, both `Date.setFullYear` and `Date.setHours` are used.\n * Noon is used as the initial reference point to avoid the time after `setFullYear`\n * from falling into an ambiguous DST period. Historically, DST transitions in all countries\n * have been scheduled around midnight, and it should be the same in the future.\n * The reason for selecting 1915 as the initial value is as follows.\n * Since DST was first established in 1916, the initial value should be set to a year prior to that.\n * If a year too far in the past is chosen, it may correspond to a period when time zones were not yet\n * precisely defined in some regions, which could result in unexpected timezone offsets.\n */\nexport const initialSafeDate = new Date(1915, 0, 1, 12, 0, 0, 0)\n\nexport const daysPerWeek = 7\nexport const hoursPerDay = 24\nexport const hoursPerWeek = hoursPerDay * daysPerWeek\nexport const minutesPerHour = 60\nexport const minutesPerDay = minutesPerHour * hoursPerDay\nexport const minutesPerWeek = minutesPerDay * daysPerWeek\nexport const secondsPerMinute = 60\nexport const secondsPerHour = secondsPerMinute * minutesPerHour\nexport const secondsPerDay = secondsPerHour * hoursPerDay\nexport const secondsPerWeek = secondsPerDay * daysPerWeek\nexport const millisecondsPerSecond = 1000\nexport const millisecondsPerMinute = secondsPerMinute * millisecondsPerSecond\nexport const millisecondsPerHour = secondsPerHour * millisecondsPerSecond\nexport const millisecondsPerDay = secondsPerDay * millisecondsPerSecond\nexport const millisecondsPerWeek = secondsPerWeek * millisecondsPerSecond\n\nexport function has(object, ...keys) {\n  return keys.flat().some(object.hasOwnProperty, object)\n}\n\nexport function fields(object) {\n  return Object.entries(object)\n    .filter(([, value]) => !isFunction(value))\n    .map(([key]) => key)\n}\n\nexport function given(arg) {\n  return arg !== undefined\n}\n\nexport function isFunction(a) {\n  return a instanceof Function\n}\n\nexport function isString(a) {\n  return typeof a === 'string' || a instanceof String\n}\n\nexport function isObject(a) {\n  return a !== null && typeof a === 'object' && a.constructor === Object\n}\n\nexport function isValidDate(date) {\n  return !Number.isNaN(date.getTime())\n}\n\nexport function hasDateField(object) {\n  return has(object, ['year', 'month', 'day'])\n}\n\nexport function hasTimeField(object) {\n  return has(object, ['hour', 'minute', 'second', 'millisecond'])\n}\n\nexport function hasDatetimeField(object) {\n  return has(object, [\n    'year',\n    'month',\n    'day',\n    'hour',\n    'minute',\n    'second',\n    'millisecond',\n  ])\n}\n","/* @ts-self-types=\"../types/qrono.d.ts\" */\nimport {\n  has,\n  given,\n  fields,\n  isObject,\n  isString,\n  isValidDate,\n  hasDatetimeField,\n  initialSafeDate,\n  daysPerWeek,\n  minutesPerDay,\n  minutesPerHour,\n  millisecondsPerMinute,\n  millisecondsPerDay,\n} from './helpers.js'\n\n// -----------------------------------------------------------------------------\n// Exports\n// -----------------------------------------------------------------------------\nconst qrono = Qrono\n\nexport { qrono }\n\n// -----------------------------------------------------------------------------\n// Static\n// -----------------------------------------------------------------------------\nQrono.date = QronoDate\n\n// NOTE Must be flat object for shallow cloning.\nconst defaultContext = {\n  localtime: false,\n  disambiguation: 'compatible',\n}\n\nfor (const key of fields(defaultContext)) {\n  Qrono[key] = function (arg) {\n    if (given(arg)) {\n      defaultContext[key] = arg\n      return this\n    }\n    return defaultContext[key]\n  }\n}\n\nQrono.context = function (context) {\n  if (given(context)) {\n    for (const key of fields(defaultContext)) {\n      if (!has(context, key)) {\n        continue\n      }\n      defaultContext[key] = context[key]\n    }\n    return this\n  }\n  return { ...defaultContext }\n}\n\nQrono.asUtc = function () {\n  defaultContext.localtime = false\n  return this\n}\n\nQrono.asLocaltime = function () {\n  defaultContext.localtime = true\n  return this\n}\n\nconst monday = 1\nconst tuesday = 2\nconst wednesday = 3\nconst thursday = 4\nconst friday = 5\nconst saturday = 6\nconst sunday = 7\n\nObject.assign(Qrono, {\n  monday,\n  tuesday,\n  wednesday,\n  thursday,\n  friday,\n  saturday,\n  sunday,\n})\n\n// -----------------------------------------------------------------------------\n// Constructor\n// -----------------------------------------------------------------------------\nconst internal = Symbol()\n\nfunction Qrono(...args) {\n  if (!new.target) {\n    return new Qrono(...args)\n  }\n  const self = {\n    // properties\n    nativeDate: null,\n    localtime: false,\n    disambiguation: 'compatible',\n    // methods\n    set,\n    parse,\n    valid,\n    context,\n    getNative,\n  }\n  this[internal] = self\n\n  // Construction\n  self.context(defaultContext)\n  if (args[0] instanceof Qrono) {\n    const source = args.shift()\n    for (const key of fields(self)) {\n      self[key] = source[key]()\n    }\n  }\n  if (isObject(args[0]) && !hasDatetimeField(args[0])) {\n    self.context(args.shift())\n  }\n  const first = args[0]\n  const second = args[1]\n  if (first == null) {\n    self.nativeDate ??= new Date()\n  } else if (first instanceof Date) {\n    self.nativeDate = new Date(first.getTime())\n  } else if (isString(first)) {\n    self.parse(first)\n  } else if (isObject(first)) {\n    if (!hasDatetimeField(first)) {\n      throw RangeError(\n        'Missing time field' +\n          ' (year, minute, day, hour, minute, second or millisecond)'\n      )\n    }\n    self.set(first)\n  } else if (Number.isFinite(first) && !Number.isFinite(second)) {\n    self.nativeDate = new Date(first)\n  } else if (Number.isFinite(first) || Array.isArray(first)) {\n    const flat = args.flat()\n    const values = flat.filter(v => Number.isSafeInteger(v))\n    if (values.length !== flat.length) {\n      throw RangeError('Should be safe integers')\n    }\n    if (values.length > 7) {\n      throw RangeError('Too many numbers')\n    }\n    self.set({\n      year: values[0],\n      month: values[1],\n      day: values[2],\n      hour: values[3],\n      minute: values[4],\n      second: values[5],\n      millisecond: values[6],\n    })\n  } else {\n    throw TypeError(`Invalid argument ${args}`)\n  }\n  return this\n}\n\n// -----------------------------------------------------------------------------\n// Private methods\n// -----------------------------------------------------------------------------\nfunction valid() {\n  return isValidDate(this.nativeDate)\n}\n\nfunction context(context) {\n  if (!context) {\n    return\n  }\n  for (const key of fields(defaultContext)) {\n    if (has(context, key)) {\n      this[key] = context[key]\n    }\n  }\n  return this\n}\n\nfunction getNative(name) {\n  return this.nativeDate[`get${this.localtime ? '' : 'UTC'}${name}`]()\n}\n\nfunction set(values) {\n  const args = { ...values }\n  args.month = args.month && args.month - 1\n  if (!this.localtime) {\n    const baseDate = this.nativeDate ?? new Date(0)\n    const newDate = new Date(0)\n    newDate.setUTCFullYear(\n      args.year ?? baseDate.getUTCFullYear(),\n      args.month ?? baseDate.getUTCMonth(),\n      args.day ?? baseDate.getUTCDate()\n    )\n    newDate.setUTCHours(\n      args.hour ?? baseDate.getUTCHours(),\n      args.minute ?? baseDate.getUTCMinutes(),\n      args.second ?? baseDate.getUTCSeconds(),\n      args.millisecond ?? baseDate.getUTCMilliseconds()\n    )\n    this.nativeDate = newDate\n    return this\n  }\n  const dateOnly = !has(values, 'hour', 'minute', 'second', 'millisecond')\n  const disambig = dateOnly ? 'later' : this.disambiguation\n  const baseDate = this.nativeDate ?? new Date(0, 0)\n  const newDate = new Date(initialSafeDate.getTime())\n  const requested = {\n    year: args.year ?? baseDate.getFullYear(),\n    month: args.month ?? baseDate.getMonth(),\n    day: args.day ?? baseDate.getDate(),\n    hour: args.hour ?? (dateOnly ? 0 : baseDate.getHours()),\n    minute: args.minute ?? (dateOnly ? 0 : baseDate.getMinutes()),\n    second: args.second ?? (dateOnly ? 0 : baseDate.getSeconds()),\n    millisecond:\n      args.millisecond ?? (dateOnly ? 0 : baseDate.getMilliseconds()),\n  }\n  newDate.setFullYear(requested.year, requested.month, requested.day)\n  newDate.setHours(\n    requested.hour,\n    requested.minute,\n    requested.second,\n    requested.millisecond\n  )\n  // Compute the offset-delta between the day before and after.\n  const numeric = newDate.getTime()\n  const nextDay = new Date(numeric)\n  nextDay.setDate(newDate.getDate() + 1)\n  const prevDay = new Date(numeric)\n  prevDay.setDate(newDate.getDate() - 1)\n  const adjust = nextDay.getTimezoneOffset() - prevDay.getTimezoneOffset()\n  // No DST transition nearby â€” nothing to resolve.\n  if (disambig === 'compatible' || adjust === 0) {\n    this.nativeDate = newDate\n    return this\n  }\n  // Detect whether the constructed Date landed in a DST gap (missing time).\n  // In a gap, JavaScript silently shifts the time forward.\n  const isGap =\n    requested.year * 1e8 +\n      requested.month * 1e6 +\n      requested.day * 1e4 +\n      requested.hour * 1e2 +\n      requested.minute <\n    newDate.getFullYear() * 1e8 +\n      newDate.getMonth() * 1e6 +\n      newDate.getDate() * 1e4 +\n      newDate.getHours() * 1e2 +\n      newDate.getMinutes()\n  // Compute the standard-time candidate.\n  // Verify the candidate actually preserves the original local fields.\n  // If it doesn't, the time isn't truly in an overlap.\n  const adjustedUTC = new Date(\n    new Date(numeric).setUTCMinutes(newDate.getUTCMinutes() + adjust)\n  )\n  const isOverlap =\n    adjustedUTC.getHours() === newDate.getHours() &&\n    adjustedUTC.getMinutes() === newDate.getMinutes()\n  if (!isGap && !isOverlap) {\n    this.nativeDate = newDate\n    return this\n  }\n  if (disambig === 'reject') {\n    throw new RangeError(`Requested local time ${requested} is ambiguous.`)\n  }\n  this.nativeDate = disambig === 'later' ? newDate : adjustedUTC\n  return this\n}\n\nconst parsePattern = new RegExp(\n  // yyyy[[-|/]MM[[-|/]DD]]\n  '^(\\\\d{4})(?:[-/]?([0-2]?\\\\d)(?:[-/]?([0-3]?\\\\d))?)?' +\n    // [(T| )HH[:]mm[[:]ss[(.|:)SSS]]]\n    '(?:[T\\\\s]([0-2]?\\\\d)(?::([0-5]?\\\\d)?(?::([0-6]?\\\\d)?(?:[.:](\\\\d{1,3})?\\\\d*)?)?)?)?' +\n    // [Z|(+|-)hh:mm]\n    '(Z|[-+]\\\\d{2}:?\\\\d{2})?$'\n)\n\nfunction parse(str) {\n  const text = str.trim().toUpperCase()\n  const values = text.match(parsePattern)\n  if (!values) {\n    throw RangeError(\n      `Failed to parse '${str}'.` +\n        ' Should be yyyy[[-|/]MM[[-|/]DD]][(T| )HH:mm[:ss[(.|:)SSS]]][Z|(+|-)hh:mm]'\n    )\n  }\n  const hasTime = values[4] !== undefined\n  const [year, month, day, offset] = [\n    +values[1],\n    +values[2] || 1,\n    +values[3] || 1,\n    values[8],\n  ]\n  const native = new Date(text)\n  if (!isValidDate(native)) {\n    throw RangeError(\n      `Failed to parse '${str}' by Date.` +\n        ' Should be yyyy[[-|/]MM[[-|/]DD]][(T| )HH:mm[:ss[(.|:)SSS]]][Z|(+|-)hh:mm]'\n    )\n  }\n  if (offset) {\n    this.nativeDate = native\n  } else if (hasTime) {\n    this.set({\n      year,\n      month,\n      day,\n      hour: +values[4] || 0,\n      minute: +values[5] || 0,\n      second: +values[6] || 0,\n      millisecond: +values[7]?.padStart(3, '0') || 0,\n    })\n  } else {\n    this.set({ year, month, day })\n  }\n  return this\n}\n\n// -----------------------------------------------------------------------------\n// Public methods\n// -----------------------------------------------------------------------------\nconst p = (v, n) => String(v).padStart(n, '0')\n\n// Basic\nQrono.prototype.toString = function () {\n  if (this[internal].localtime) {\n    const t = this[internal].nativeDate\n    const offset = -t.getTimezoneOffset()\n    const offsetAbs = Math.abs(offset)\n    return (\n      `${p(t.getFullYear(), 4)}-` +\n      `${p(t.getMonth() + 1, 2)}-` +\n      `${p(t.getDate(), 2)}T` +\n      `${p(t.getHours(), 2)}:` +\n      `${p(t.getMinutes(), 2)}:` +\n      `${p(t.getSeconds(), 2)}.` +\n      `${p(t.getMilliseconds(), 3)}` +\n      `${offset >= 0 ? '+' : '-'}` +\n      `${p(Math.trunc(offsetAbs / minutesPerHour), 2)}:` +\n      `${p(offsetAbs % minutesPerHour, 2)}`\n    )\n  }\n  return this[internal].nativeDate.toISOString()\n}\n\nQrono.prototype.valueOf = function () {\n  return this[internal].nativeDate.valueOf()\n}\n\nQrono.prototype.clone = function (...args) {\n  return new Qrono(this, ...args)\n}\n\nQrono.prototype.context = function (context) {\n  return given(context)\n    ? this.clone(context)\n    : {\n        localtime: this[internal].localtime,\n        disambiguation: this[internal].disambiguation,\n      }\n}\n\nQrono.prototype.nativeDate = function () {\n  return new Date(this[internal].nativeDate.getTime())\n}\n\nQrono.prototype.offset = function () {\n  return this[internal].localtime\n    ? -this[internal].nativeDate.getTimezoneOffset()\n    : 0\n}\n\nQrono.prototype.localtime = function (arg) {\n  return given(arg) ? this.clone({ localtime: arg }) : this[internal].localtime\n}\n\nQrono.prototype.disambiguation = function (arg) {\n  return given(arg)\n    ? this.clone({ disambiguation: arg })\n    : this[internal].disambiguation\n}\n\nQrono.prototype.valid = function () {\n  return this[internal].valid()\n}\n\n// Transform\nQrono.prototype.numeric = function () {\n  return this[internal].nativeDate.getTime()\n}\n\nQrono.prototype.toObject = function () {\n  return {\n    year: this.year(),\n    month: this.month(),\n    day: this.day(),\n    hour: this.hour(),\n    minute: this.minute(),\n    second: this.second(),\n    millisecond: this.millisecond(),\n  }\n}\n\nQrono.prototype.toArray = function () {\n  return [\n    this.year(),\n    this.month(),\n    this.day(),\n    this.hour(),\n    this.minute(),\n    this.second(),\n    this.millisecond(),\n  ]\n}\n\nQrono.prototype.toDate = function (...args) {\n  return new QronoDate(this.clone(...args))\n}\n\n// Context\nQrono.prototype.asUtc = function () {\n  return this.clone({ localtime: false })\n}\n\nQrono.prototype.asLocaltime = function () {\n  return this.clone({ localtime: true })\n}\n\n// Accessor\nfor (const [field, native, offset] of [\n  ['year', 'FullYear', 0],\n  ['month', 'Month', 1],\n  ['day', 'Date', 0],\n  ['hour', 'Hours', 0],\n  ['minute', 'Minutes', 0],\n  ['second', 'Seconds', 0],\n  ['millisecond', 'Milliseconds', 0],\n]) {\n  Qrono.prototype[field] = function (value) {\n    return given(value)\n      ? this.clone({ [field]: value })\n      : this[internal].getNative(native) + offset\n  }\n}\n\n// Getter\nQrono.prototype.dayOfWeek = function () {\n  return 1 + ((this[internal].getNative('Day') - 1 + daysPerWeek) % daysPerWeek)\n}\n\nQrono.prototype.dayOfYear = function () {\n  const date = this.toDate()\n  return 1 + date - date.startOfYear()\n}\n\nQrono.prototype.weekOfYear = function () {\n  const date = this.toDate()\n  const theThursday = date.day(date.day() - date.dayOfWeek() + thursday)\n  const startOfYear = theThursday.startOfYear()\n  const firstThursday =\n    startOfYear.dayOfWeek() === thursday\n      ? startOfYear\n      : startOfYear.day(\n          1 + ((thursday - startOfYear.dayOfWeek() + daysPerWeek) % daysPerWeek)\n        )\n  return 1 + Math.ceil((theThursday - firstThursday) / daysPerWeek)\n}\n\nQrono.prototype.yearOfWeek = function () {\n  const date = this.toDate()\n  return date.day(date.day() - date.dayOfWeek() + thursday).year()\n}\n\nQrono.prototype.isLeapYear = function () {\n  const year = this.year()\n  return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)\n}\n\nQrono.prototype.hasDstInYear = function () {\n  if (!this[internal].localtime) {\n    return false\n  }\n  const currentOffset = this.offset()\n  return [3, 6, 9, 12]\n    .map(month => this.month(month).offset())\n    .some(offset => offset !== currentOffset)\n}\n\nQrono.prototype.isInDst = function () {\n  if (!this[internal].localtime) {\n    return false\n  }\n  const offsets = Array.from({ length: 12 }, (_, index) =>\n    this.month(index + 1).offset()\n  )\n  const minOffset = Math.min(...offsets)\n  const maxOffset = Math.max(...offsets)\n  return minOffset !== maxOffset && this.offset() === maxOffset\n}\n\nQrono.prototype.isDstTransitionDay = function () {\n  if (!this[internal].localtime) {\n    return false\n  }\n  return this.minutesInDay() !== minutesPerDay\n}\n\nQrono.prototype.minutesInDay = function () {\n  if (!this[internal].localtime) {\n    return minutesPerDay\n  }\n  const startOfDay = this.context({ disambiguation: 'later' }).startOfDay()\n  const nextDay = startOfDay.plus({ day: 1 }).startOfDay()\n  if (startOfDay.day() === nextDay.day()) {\n    return minutesPerDay\n  }\n  return (nextDay - startOfDay) / millisecondsPerMinute\n}\n\nQrono.prototype.daysInMonth = function () {\n  const days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\n  const month = this.month()\n  return days[month - 1] + (this.isLeapYear() && month === 2 ? 1 : 0)\n}\n\nQrono.prototype.daysInYear = function () {\n  return this.isLeapYear() ? 366 : 365\n}\n\nQrono.prototype.weeksInYear = function () {\n  const endOfYear = this.toDate({ month: 12, day: 31 })\n  const endOfLastYear = endOfYear.minus({ year: 1 })\n  if (\n    endOfYear.dayOfWeek() === thursday ||\n    endOfLastYear.dayOfWeek() === wednesday\n  ) {\n    return 53\n  }\n  return 52\n}\n\nfor (const [name, cloneArg] of [\n  ['Year', { month: 1, day: 1, hour: 0, minute: 0, second: 0, millisecond: 0 }],\n  ['Month', { day: 1, hour: 0, minute: 0, second: 0, millisecond: 0 }],\n  ['Hour', { minute: 0, second: 0, millisecond: 0 }],\n  ['Minute', { second: 0, millisecond: 0 }],\n  ['Second', { millisecond: 0 }],\n]) {\n  Qrono.prototype[`startOf${name}`] = function () {\n    return this.clone(cloneArg)\n  }\n}\n\nQrono.prototype.startOfDay = function () {\n  const timestamp = this.clone(\n    { disambiguation: 'later' },\n    { hour: 0, minute: 0, second: 0, millisecond: 0 }\n  ).numeric()\n  return this.clone(timestamp)\n}\n\nQrono.prototype.isSame = function (another) {\n  return +this === +another\n}\nQrono.prototype.isBefore = function (another) {\n  return this < another\n}\nQrono.prototype.isAfter = function (another) {\n  return this > another\n}\nQrono.prototype.isSameOrBefore = function (another) {\n  return this <= another\n}\nQrono.prototype.isSameOrAfter = function (another) {\n  return this >= another\n}\nQrono.prototype.isBetween = function (a, b) {\n  return (a <= this && this <= b) || (b <= this && this <= a)\n}\n\n// Calculation\nQrono.prototype.plus = function (...args) {\n  return plus.call(this, 1, ...args)\n}\n\nQrono.prototype.minus = function (...args) {\n  return plus.call(this, -1, ...args)\n}\n\nfunction plus(sign, ...args) {\n  const arg0 = args[0]\n  const arg1 = args[1]\n  if (Number.isFinite(arg0) && !Number.isFinite(arg1)) {\n    return this.clone(this.numeric() + arg0)\n  }\n  let timeFields = null\n  if (isObject(arg0)) {\n    if (!hasDatetimeField(arg0)) {\n      throw RangeError(\n        'Missing time field' +\n          ' (year, minute, day, hour, minute, second or millisecond)'\n      )\n    }\n    timeFields = arg0\n  } else if (Number.isFinite(arg0) || Array.isArray(arg0)) {\n    const flat = args.flat()\n    const values = flat.filter(v => Number.isSafeInteger(v))\n    if (values.length !== flat.length) {\n      throw RangeError('Should be safe integers')\n    }\n    if (values.length > 7) {\n      throw RangeError('Too many numbers')\n    }\n    timeFields = {\n      year: values[0],\n      month: values[1],\n      day: values[2],\n      hour: values[3],\n      minute: values[4],\n      second: values[5],\n      millisecond: values[6],\n    }\n  } else {\n    throw TypeError()\n  }\n  const date = this.nativeDate()\n  const utc = this[internal].localtime ? '' : 'UTC'\n  if (has(timeFields, 'year') || has(timeFields, 'month')) {\n    const year = this.year() + sign * (timeFields.year ?? 0)\n    const month = this.month() + sign * (timeFields.month ?? 0)\n    const endOfMonth = new Date(date.getTime())\n    endOfMonth[`set${utc}FullYear`](year, month, 0)\n    const lastDay = endOfMonth[`get${utc}Date`]()\n    if (lastDay < this.day()) {\n      date[`set${utc}FullYear`](year, endOfMonth[`get${utc}Month`](), lastDay)\n    } else {\n      date[`set${utc}FullYear`](year, month - 1)\n    }\n  }\n  if (has(timeFields, 'day')) {\n    date[`set${utc}Date`](date[`get${utc}Date`]() + sign * timeFields.day)\n  }\n  for (const [key, nativeKey] of [\n    ['hour', 'Hours'],\n    ['minute', 'Minutes'],\n    ['second', 'Seconds'],\n    ['millisecond', 'Milliseconds'],\n  ]) {\n    if (!has(timeFields, key) || timeFields[key] == null) {\n      continue\n    }\n    date[`setUTC${nativeKey}`](\n      date[`getUTC${nativeKey}`]() + sign * timeFields[key]\n    )\n  }\n  return this.clone(date)\n}\n\n// -----------------------------------------------------------------------------\n// QronoDate Class\n// -----------------------------------------------------------------------------\nconst internalDate = Symbol()\n\nfunction QronoDate(...args) {\n  if (!new.target) {\n    return new QronoDate(...args)\n  }\n  const self = { datetime: null }\n  this[internalDate] = self\n  let source = null\n  if (args[0] instanceof QronoDate) {\n    source = args.shift().toDatetime()\n  } else if (args[0] instanceof Qrono) {\n    source = args.shift()\n  }\n  const first = args[0]\n  const second = args[1]\n  if (Number.isFinite(first) && !Number.isFinite(second)) {\n    args[0] = Math.floor(first) * millisecondsPerDay\n  }\n  if (source) {\n    source = source.clone(...args)\n  } else {\n    source = qrono(...args)\n  }\n  self.datetime = source.startOfDay()\n  return this\n}\n\nQronoDate.prototype.toString = function () {\n  return this[internalDate].datetime.toString().substring(0, 10)\n}\n\nQronoDate.prototype.valueOf = function () {\n  return this[internalDate].datetime / millisecondsPerDay\n}\n\nQronoDate.prototype.valid = function () {\n  return this[internalDate].datetime.valid()\n}\n\nQronoDate.prototype.clone = function (...args) {\n  return new QronoDate(this, ...args)\n}\n\nQronoDate.prototype.toDatetime = function () {\n  return qrono(this[internalDate].datetime.toArray())\n}\n\nQronoDate.prototype.numeric = function () {\n  return this[internalDate].datetime.numeric() / millisecondsPerDay\n}\n\nQronoDate.prototype.toObject = function () {\n  return {\n    year: this.year(),\n    month: this.month(),\n    day: this.day(),\n  }\n}\n\nQronoDate.prototype.toArray = function () {\n  return [this.year(), this.month(), this.day()]\n}\n\nQronoDate.prototype.startOfYear = function () {\n  return new QronoDate(this[internalDate].datetime.startOfYear())\n}\n\nQronoDate.prototype.startOfMonth = function () {\n  return new QronoDate(this[internalDate].datetime.startOfMonth())\n}\n\nQronoDate.prototype.startOfDay = function () {\n  return this[internalDate].datetime.clone()\n}\nfor (const field of ['year', 'month', 'day']) {\n  QronoDate.prototype[field] = function (value) {\n    if (given(value)) {\n      return new QronoDate(this[internalDate].datetime[field](value))\n    }\n    return this[internalDate].datetime[field]()\n  }\n}\nfor (const method of [\n  'dayOfWeek',\n  'dayOfYear',\n  'weekOfYear',\n  'yearOfWeek',\n  'isLeapYear',\n  'daysInMonth',\n  'daysInYear',\n  'weeksInYear',\n]) {\n  QronoDate.prototype[method] = function () {\n    return this[internalDate].datetime[method]()\n  }\n}\nfor (const method of ['minutesInDay', 'hasDstInYear', 'isDstTransitionDay']) {\n  QronoDate.prototype[method] = function () {\n    return qrono(\n      { disambiguation: 'later' },\n      this[internalDate].datetime.toArray().slice(0, 3)\n    )[method]()\n  }\n}\n\nQronoDate.prototype.endOfYear = function () {\n  return this.clone({ month: 12, day: 31 })\n}\n\nQronoDate.prototype.endOfMonth = function () {\n  return this.clone({ day: this.daysInMonth() })\n}\n\nQronoDate.prototype.isSame = function (another) {\n  return +this === +another\n}\nQronoDate.prototype.isBefore = function (another) {\n  return this < another\n}\nQronoDate.prototype.isAfter = function (another) {\n  return this > another\n}\nQronoDate.prototype.isSameOrBefore = function (another) {\n  return this <= another\n}\nQronoDate.prototype.isSameOrAfter = function (another) {\n  return this >= another\n}\nQronoDate.prototype.isBetween = function (a, b) {\n  return (a <= this && this <= b) || (b <= this && this <= a)\n}\n\nQronoDate.prototype.plus = function (...args) {\n  return plusDate.call(this, 1, ...args)\n}\n\nQronoDate.prototype.minus = function (...args) {\n  return plusDate.call(this, -1, ...args)\n}\n\nfunction plusDate(sign, ...args) {\n  const arg0 = args[0]\n  const arg1 = args[1]\n  const datetime = this[internalDate].datetime\n  if (Number.isFinite(arg0) && !Number.isFinite(arg1)) {\n    return datetime.plus({ day: sign * arg0 }).toDate()\n  }\n  let timeFields = null\n  if (isObject(arg0) && hasDatetimeField(arg0)) {\n    timeFields = {\n      year: sign * (arg0.year ?? 0),\n      month: sign * (arg0.month ?? 0),\n      day: sign * (arg0.day ?? 0),\n    }\n  } else if (Number.isFinite(arg0)) {\n    if (args.length > 3) {\n      throw RangeError('Too many arguments')\n    }\n    timeFields = { year: sign * arg0, month: sign * arg1, day: sign * arg2 }\n  } else if (Array.isArray(arg0)) {\n    if (arg0.length > 3) {\n      throw RangeError('Too many elements')\n    }\n    timeFields = {\n      year: sign * arg0[0],\n      month: sign * arg0[1],\n      day: sign * arg0[2],\n    }\n  } else {\n    throw TypeError()\n  }\n  return datetime.plus(timeFields).toDate()\n}\n"],"names":["initialSafeDate","daysPerWeek","hoursPerDay","minutesPerHour","minutesPerDay","secondsPerMinute","secondsPerHour","secondsPerDay","millisecondsPerSecond","millisecondsPerMinute","millisecondsPerDay","has","object","keys","fields","value","isFunction","key","given","arg","a","isString","isObject","isValidDate","date","hasDatetimeField","qrono","Qrono","QronoDate","defaultContext","context","__spreadValues","monday","tuesday","wednesday","thursday","friday","saturday","sunday","internal","args","_a","self","set","parse","valid","getNative","source","first","second","flat","values","v","name","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","_m","_n","_o","_p","baseDate","newDate","dateOnly","disambig","requested","numeric","nextDay","prevDay","adjust","isGap","adjustedUTC","isOverlap","parsePattern","str","text","hasTime","year","month","day","offset","native","n","offsetAbs","field","theThursday","startOfYear","firstThursday","currentOffset","offsets","_","index","minOffset","maxOffset","startOfDay","days","endOfYear","endOfLastYear","cloneArg","timestamp","another","b","plus","sign","arg0","arg1","timeFields","utc","endOfMonth","lastDay","nativeKey","internalDate","method","plusDate","datetime"],"mappings":"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"}